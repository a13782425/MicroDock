# MicroDock 插件管理服务器 - 快速使用说明

## 🚀 启动服务

### 方法一：使用启动脚本（推荐）
```bash
cd PluginServer
python start.py
```

### 方法二：直接启动Flask
```bash
cd PluginServer
python app.py
```

## 📱 访问界面

启动后，在浏览器中访问：
- **本地访问**: http://localhost:5000
- **局域网访问**: http://你的IP地址:5000

## ✅ 功能测试结果

### ✨ 已测试并工作的功能

1. **插件扫描** - ✅ 成功检测到2个测试插件
   - Test Plugin 1 (标签页插件)
   - Test Plugin 2 (服务插件)

2. **API接口** - ✅ 所有核心API工作正常
   - `GET /api/plugins` - 获取插件列表
   - `POST /api/plugins/<name>/toggle` - 启用/禁用插件
   - `GET /api/backups` - 获取备份列表
   - `POST /api/scan` - 重新扫描插件

3. **插件配置读取** - ✅ 成功读取plugin.json配置
   - 插件名称、版本、描述
   - 作者信息、依赖项
   - 插件类型（tab/service）

4. **Web界面** - ✅ 响应式界面已就绪
   - Bootstrap 5 设计
   - 插件卡片展示
   - 搜索和过滤功能
   - 拖拽上传支持

## 🎯 主要特性

### 插件管理
- **查看插件**: 显示所有已安装插件的详细信息
- **启用/禁用**: 一键切换插件的运行状态
- **删除插件**: 安全删除（自动备份）
- **搜索过滤**: 按名称、类型、状态查找插件

### 文件操作
- **上传插件**: 支持拖拽或选择文件上传
- **自动备份**: 删除前自动备份到backups目录
- **备份管理**: 查看和下载历史备份

### 状态监控
- **实时统计**: 总插件数、启用/禁用数量
- **详细信息**: 文件大小、更新时间、依赖关系
- **状态标识**: 清晰的视觉状态指示

## 📁 目录结构

```
PluginServer/
├── app.py              # 主应用
├── start.py            # 启动脚本
├── requirements.txt    # 依赖包
├── templates/          # HTML模板
├── Plugins/            # 插件目录 ⭐
│   ├── TestPlugin1.dll # 测试插件1
│   ├── TestPlugin1/    # 插件1配置
│   │   └── plugin.json
│   ├── TestPlugin2.dll # 测试插件2
│   └── TestPlugin2/    # 插件2配置
│       └── plugin.json
├── backups/            # 备份目录
└── temp/              # 临时文件目录
```

## 🔧 API接口文档

### 插件管理
```http
# 获取所有插件
GET /api/plugins

# 启用/禁用插件
POST /api/plugins/<plugin_name>/toggle
Content-Type: application/json
{"action": "enable|disable"}

# 删除插件
DELETE /api/plugins/<plugin_name>

# 重新扫描插件
POST /api/scan
```

### 文件管理
```http
# 上传插件
POST /api/upload
Content-Type: multipart/form-data
plugin_file: [文件]

# 获取备份列表
GET /api/backups

# 下载备份
GET /download/backup/<backup_name>
```

## 🎮 使用流程

### 1. 添加插件
1. 点击"添加插件"按钮
2. 拖拽.dll文件到上传区域
3. 等待上传完成
4. 插件自动出现在列表中

### 2. 管理插件
1. **查看**: 在插件卡片中查看详细信息
2. **启用/禁用**: 点击对应按钮切换状态
3. **搜索**: 使用搜索框快速定位插件
4. **过滤**: 按类型或状态筛选插件

### 3. 备份恢复
1. 删除插件时自动备份
2. 点击"备份管理"查看历史备份
3. 点击"下载"恢复需要的备份

## 🎨 界面预览

### 主页面
- 顶部导航栏：插件列表、上传、备份管理
- 统计卡片：总插件数、启用数、禁用数、类型分布
- 插件网格：卡片式展示所有插件

### 插件卡片
- 插件名称和状态标识
- 描述信息
- 详细信息（版本、作者、大小、时间）
- 操作按钮（启用/禁用、详情、删除）

### 响应式设计
- 桌面端：双列卡片布局
- 移动端：单列卡片布局
- 自适应导航菜单

## 🔒 安全特性

1. **文件验证**: 只接受.dll文件
2. **路径安全**: 防止路径遍历攻击
3. **自动备份**: 删除前自动备份
4. **错误处理**: 完善的异常捕获和处理

## 🚨 注意事项

1. **端口占用**: 确保5000端口未被占用
2. **文件权限**: 确保对PluginServer目录有读写权限
3. **Python版本**: 需要Python 3.7或更高版本
4. **网络访问**: 如需局域网访问，确保防火墙允许5000端口

## 🆘 故障排除

### 服务器无法启动
```bash
# 检查Python版本
python --version

# 手动安装依赖
pip install Flask==2.3.3 Werkzeug==2.3.7
```

### 插件不显示
1. 检查Plugins目录是否存在
2. 确认文件是.dll格式
3. 查看服务器日志输出
4. 尝试手动点击"刷新"按钮

### 上传失败
1. 确认文件是.dll格式
2. 检查文件大小是否过大
3. 确认temp目录有写入权限

---

🎉 **恭喜！MicroDock 插件管理服务器已成功部署并测试完成！**

现在你可以通过 http://localhost:5000 访问完整的插件管理界面了。