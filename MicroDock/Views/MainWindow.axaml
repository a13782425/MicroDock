<Window
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:MicroDock.ViewModels"
	xmlns:models="using:MicroDock.Models"
    mc:Ignorable="d"
    d:DesignWidth="500"
    d:DesignHeight="350"
	Width="500"
	Height="350"
    x:Class="MicroDock.Views.MainWindow"
    x:DataType="vm:MainWindowViewModel"
    ExtendClientAreaToDecorationsHint="True"
    ExtendClientAreaChromeHints="NoChrome"
    CanResize="False"
    Icon="/Assets/avalonia-logo.ico">

	<Window.Styles>
		<!-- 鼠标悬停时的样式 -->
		<Style Selector="Button.CloseButton:pointerover">
			<Setter Property="Background" Value="{DynamicResource ButtonBackgroundPointerOver}"/>
		</Style>
		<!-- 按下时的样式 -->
		<Style Selector="Button.CloseButton:pressed">
			<Setter Property="Background" Value="{DynamicResource ButtonBackgroundPressed}"/>
		</Style>
		<!-- TabItem 样式 -->
		<Style Selector="TabItem">
			<Setter Property="Padding" Value="6,0,6,6"/>
			<Setter Property="MinHeight" Value="36"/>
		</Style>
	</Window.Styles>

	<Design.DataContext>
		<vm:MainWindowViewModel />
	</Design.DataContext>
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="30"/>
			<!-- 自定义标题栏 -->
			<RowDefinition Height="*"/>
			<!-- 内容区域 -->
		</Grid.RowDefinitions>

	<!-- 自定义标题栏 -->
	<Grid Grid.Row="0" Background="{DynamicResource SystemAccentColor}" PointerPressed="TitleBar_PointerPressed">
		<TextBlock Text="MicroDock"
                       VerticalAlignment="Center"
                       Margin="10,0"
                       Foreground="White"/>

			<!-- 自定义关闭按钮 -->
			<Button Content="✕"
                    Width="30"
                    Height="30"
					Classes="CloseButton"
					Padding="0"
					VerticalContentAlignment="Center"
					HorizontalContentAlignment="Center"
                    HorizontalAlignment="Right"
					Background="Transparent"
                    Click="CloseButton_OnClick"/>
		</Grid>

		<!-- 内容区域 - 页签容器 -->
		<TabControl Grid.Row="1"
                    ItemsSource="{Binding Tabs}"
                    SelectedIndex="{Binding SelectedTabIndex}"
                    Background="Transparent">
			<TabControl.ItemTemplate>
				<DataTemplate DataType="models:TabItemModel">
					<StackPanel Orientation="Horizontal">
						<TextBlock Text="{Binding Header}"
								   FontSize="16"
								   FontWeight="Bold"
								   HorizontalAlignment="Center"
								   VerticalAlignment="Center"/>
						<!-- 可关闭的页签显示关闭按钮 -->
						<Button Content="x"
                                FontSize="16"
                                Width="20"
                                Padding="0"
								Background="Transparent"
								VerticalAlignment="Center"
								HorizontalContentAlignment="Center"
                                IsVisible="{Binding IsClosable}"
                                Command="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).RemoveTabCommand}"
                                CommandParameter="{Binding}"/>
					</StackPanel>
				</DataTemplate>
			</TabControl.ItemTemplate>
			<TabControl.ContentTemplate>
				<DataTemplate DataType="models:TabItemModel">
					<Border Background="#40FFFFFF" Padding="2">
						<!-- 直接绑定 Content 属性，控件实例在 ViewModel 中创建 -->
						<ContentControl Content="{Binding Content}"/>
					</Border>
				</DataTemplate>
			</TabControl.ContentTemplate>
		</TabControl>

	</Grid>
	<!-- <Panel> -->
	<!-- 毛玻璃背景层 -->
	<!-- <ExperimentalAcrylicBorder IsHitTestVisible="False"> -->
	<!--     <ExperimentalAcrylicBorder.Material> -->
	<!--         <ExperimentalAcrylicMaterial -->
	<!--             BackgroundSource="Digger" -->
	<!--             TintColor="White" -->
	<!--             TintOpacity="0.6" -->
	<!--             MaterialOpacity="0.5" -->
	<!--             FallbackColor="White"/> -->
	<!--     </ExperimentalAcrylicBorder.Material> -->
	<!-- </ExperimentalAcrylicBorder> -->
	<!-- 毛玻璃背景 -->
	<!-- <Border CornerRadius="15" -->
	<!--         Margin="10" -->
	<!--         Background="#40FFFFFF" -->
	<!--         BorderBrush="#60FFFFFF" -->
	<!--         BorderThickness="1"> -->
	<!--     <Border.Effect> -->
	<!--         <DropShadowEffect Color="Black"  -->
	<!--                           BlurRadius="20"  -->
	<!--                           Opacity="0.3"/> -->
	<!--     </Border.Effect> -->
	<!--      -->
	<!--     ~1~ Dock 图标 @1@ -->
	<!--     <StackPanel Orientation="Horizontal" -->
	<!--                 Spacing="15" -->
	<!--                 Margin="15,10" -->
	<!--                 HorizontalAlignment="Center" -->
	<!--                 VerticalAlignment="Center"> -->
	<!--          -->
	<!--         <Image Source="/Assets/avalonia-logo.ico"  -->
	<!--                Width="48" Height="48" -->
	<!--                Cursor="Hand"/> -->
	<!--          -->
	<!--         <Image Source="/Assets/avalonia-logo.ico"  -->
	<!--                Width="48" Height="48" -->
	<!--                Cursor="Hand"/> -->
	<!--          -->
	<!--         <Image Source="/Assets/avalonia-logo.ico"  -->
	<!--                Width="48" Height="48" -->
	<!--                Cursor="Hand"/> -->
	<!--          -->
	<!--         ~1~ 分隔线 @1@ -->
	<!--         <Border Width="2" Height="40" -->
	<!--                 Background="#80000000" -->
	<!--                 CornerRadius="1" -->
	<!--                 Margin="5,0"/> -->
	<!--          -->
	<!--         <Image Source="/Assets/avalonia-logo.ico"  -->
	<!--                Width="48" Height="48" -->
	<!--                Cursor="Hand"/> -->
	<!--     </StackPanel> -->
	<!-- </Border> -->
	<!-- </Panel> -->
</Window>