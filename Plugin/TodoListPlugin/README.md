# TodoList 待办清单插件

## 简介

TodoListPlugin 是一个功能完整的待办事项管理插件，采用扑克牌式卡片视图，支持自定义页签、自定义字段、筛选和提醒功能。

## 功能特性

### ✨ 核心功能

1. **自定义页签**
   - 创建、编辑、删除页签
   - 自定义页签颜色
   - 拖动排序支持
   - 默认提供：未开始、进行中、完成 三个页签

2. **卡片式视图**
   - 扑克牌风格的卡片设计
   - 280px 固定宽度，圆角 12px
   - 阴影效果和悬停动画
   - 横向滚动，多列显示

3. **拖放功能**
   - 卡片可在不同页签间拖动
   - 实时更新数据
   - 流畅的拖放体验

4. **自定义字段**
   - 全局字段模板管理
   - 支持 4 种字段类型：
     - Text（文本）
     - Number（数字）
     - Date（日期）
     - Bool（布尔）
   - 字段可设置为必填
   - 字段可配置是否支持筛选

5. **筛选系统**
   - 多条件筛选（AND 逻辑）
   - 不同字段类型支持不同操作符：
     - Text: 包含、等于
     - Number: =、>、<、>=、<=
     - Date: =、>、<
     - Bool: 等于
   - 实时筛选结果

6. **提醒系统**
   - 设置提醒时间
   - 系统通知集成
   - 快捷设置：1小时后、明天、下周一
   - 自动定时检查（每分钟）

### 📋 待办事项管理

每个待办事项包含：
- 标题（必填）
- 简述
- 所属页签
- 自定义字段值
- 提醒设置（可选）
- 创建时间

### ⚙️ 插件设置

在主应用的设置页面中可以：
1. **管理页签**
   - 添加新页签
   - 编辑页签名称和颜色
   - 删除页签（需先转移待办）

2. **管理字段模板**
   - 添加新字段
   - 编辑字段属性
   - 删除字段（会删除所有卡片中的该字段数据）

## 数据存储

所有数据存储在插件的 Data 目录中：
- `columns.json` - 页签配置
- `items.json` - 待办事项
- `fieldTemplates.json` - 字段模板

数据格式：JSON，所有修改立即保存。

## 使用说明

### 添加待办

1. 点击顶部"添加待办"按钮，或
2. 点击任意页签底部的"+ 添加待办"按钮
3. 填写标题、简述、自定义字段
4. 选择页签
5. （可选）设置提醒
6. 点击"保存"

### 编辑待办

- 双击卡片，或
- 点击卡片右上角菜单 → 编辑

### 删除待办

- 点击卡片右上角菜单 → 删除

### 移动待办

- 按住卡片拖动到目标页签

### 筛选待办

1. 点击"筛选"按钮
2. 选择要筛选的字段
3. 选择操作符
4. 输入筛选值
5. 点击"添加筛选条件"
6. 点击"应用"

### 管理页签

1. 前往设置 → 待办清单
2. 在"页签管理"区域：
   - 添加新页签
   - 编辑现有页签
   - 删除页签

### 管理字段模板

1. 前往设置 → 待办清单
2. 在"自定义字段模板"区域：
   - 添加新字段
   - 选择字段类型
   - 设置是否必填
   - 设置是否支持筛选

## 技术实现

### 架构

- **插件主类**: `TodoListPlugin.cs`
- **MVVM模式**: 使用 ViewModel 管理数据和状态
- **数据持久化**: JSON 文件存储
- **UI 框架**: Avalonia UI + FluentAvaloniaUI

### 核心组件

1. **TodoListTabView** - 主视图
   - 横向 ItemsControl 排列页签
   - 动态加载卡片
   - 筛选面板

2. **TodoCard** - 卡片组件
   - 扑克牌样式
   - 拖放支持
   - 自定义字段显示

3. **TodoEditDialog** - 编辑对话框
   - 动态字段生成
   - 提醒设置
   - 数据验证

4. **ColumnSettingsView** - 页签设置
   - 页签列表
   - 添加/编辑/删除操作

5. **FieldTemplateSettingsView** - 字段模板设置
   - 模板列表
   - 类型选择
   - 筛选配置

### 提醒系统实现

- 使用 `System.Threading.Timer` 每分钟检查一次
- 检查所有启用提醒且未触发的事项
- 到达提醒时间时显示系统通知
- 标记为已触发避免重复提醒

## 注意事项

1. **拖放功能**: 使用了已弃用的 DataObject API，未来可能需要更新
2. **字段删除**: 删除字段模板会清除所有待办事项中的相关数据，请谨慎操作
3. **页签删除**: 只能删除没有待办事项的页签
4. **提醒触发**: 提醒触发后会标记为已触发，修改提醒时间会重置此状态

## 开发信息

- **版本**: 1.0.0
- **作者**: MicroDock
- **许可证**: MIT
- **依赖**:
  - MicroDock.Plugin
  - Avalonia 11.3.8
  - FluentAvaloniaUI 2.4.0

## 未来改进

- [ ] 拖放 API 升级（使用新的 DoDragDropAsync）
- [ ] 添加卡片搜索历史记录
- [ ] 支持批量操作
- [ ] 添加卡片标签系统
- [ ] 导出/导入功能
- [ ] 数据备份和恢复
- [ ] 更多视图模式（列表视图、日历视图）
- [ ] 任务进度追踪
- [ ] 子任务支持

## 构建说明

```bash
cd Plugin/TodoListPlugin
dotnet build
```

编译成功后，将输出目录中的所有文件复制到 MicroDock 的 `Plugins/TodoListPlugin/` 目录中。

## 许可

MIT License

