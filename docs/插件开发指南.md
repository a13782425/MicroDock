# MicroDock æ’ä»¶å¼€å‘æŒ‡å—

## ç‰ˆæœ¬ä¿¡æ¯
- **æ–‡æ¡£ç‰ˆæœ¬**: 3.3.0
- **æœ€åæ›´æ–°**: 2025-11-27
- **é€‚ç”¨ MicroDock ç‰ˆæœ¬**: 0.0.4.0+

## ç›®å½•
- [æ¦‚è¿°](#æ¦‚è¿°)
- [plugin.json é…ç½®æ–‡ä»¶](#pluginjson-é…ç½®æ–‡ä»¶) â­ **é‡è¦æ›´æ–°**
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [æ’ä»¶æ¥å£](#æ’ä»¶æ¥å£)
- [æ’ä»¶å·¥å…·ç³»ç»Ÿ](#æ’ä»¶å·¥å…·ç³»ç»Ÿ) ğŸ†• **å…¨æ–°åŠŸèƒ½**
- [UI é¡µç­¾å¼€å‘è§„èŒƒ](#ui-é¡µç­¾å¼€å‘è§„èŒƒ)
- [æ’ä»¶ä¸Šä¸‹æ–‡ API](#æ’ä»¶ä¸Šä¸‹æ–‡-api) ğŸ†• **æ–°å¢ç« èŠ‚**
  - [æ—¥å¿—ç³»ç»Ÿ](#-æ—¥å¿—ç³»ç»Ÿ)
  - [å›¾ç‰‡ç®¡ç†](#ï¸-å›¾ç‰‡ç®¡ç†)
  - [è·¯å¾„ç®¡ç†](#-è·¯å¾„ç®¡ç†)
  - [é€šçŸ¥ç³»ç»Ÿ](#-é€šçŸ¥ç³»ç»Ÿ)
  - [Loading æŒ‡ç¤ºå™¨](#-loading-æŒ‡ç¤ºå™¨)
  - [æ‰˜ç›˜èœå•](#-æ‰˜ç›˜èœå•)
  - [é€šè¿‡å·¥å…·å…±äº«é…ç½®](#-é€šè¿‡å·¥å…·å…±äº«é…ç½®)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æ¦‚è¿°

MicroDock æä¾›äº†ä¸€ä¸ªçµæ´»çš„æ’ä»¶ç³»ç»Ÿï¼Œå…è®¸ç¬¬ä¸‰æ–¹å¼€å‘è€…æ‰©å±•åº”ç”¨åŠŸèƒ½ã€‚æ’ä»¶å¯ä»¥ï¼š
- æ·»åŠ æ–°çš„ UI æ ‡ç­¾é¡µ
- æä¾›è‡ªå®šä¹‰æ“ä½œå’ŒæœåŠ¡
- é›†æˆå¤–éƒ¨å·¥å…·å’ŒæœåŠ¡

### æŠ€æœ¯æ ˆ
- **.NET 8.0**: æ’ä»¶å¿…é¡»åŸºäº .NET 8.0 å¼€å‘
- **Avalonia UI**: ç”¨äºåˆ›å»ºè·¨å¹³å° UI ç»„ä»¶
- **MicroDock.Plugin**: æ ¸å¿ƒæ’ä»¶æ¡†æ¶åº“

---

## plugin.json é…ç½®æ–‡ä»¶

### â­ é‡è¦æ›´æ–°ï¼ˆv0.0.2.0+ï¼‰

ä» MicroDock v0.0.2.0 å¼€å§‹ï¼Œ**æ‰€æœ‰æ’ä»¶å¿…é¡»æä¾› `plugin.json` é…ç½®æ–‡ä»¶**ã€‚è¿™ä¸ªæ–‡ä»¶ç”¨äºå®šä¹‰æ’ä»¶çš„å…ƒæ•°æ®ï¼Œæ’ä»¶æ¥å£ä¸å†éœ€è¦å®ç°å…ƒæ•°æ®ç›¸å…³çš„å±æ€§ã€‚

### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ plugin.jsonï¼Ÿ

- **å…ƒæ•°æ®ä¸ä»£ç åˆ†ç¦»**: æ’ä»¶å…ƒæ•°æ®ä¸å†è€¦åˆåœ¨ä»£ç ä¸­ï¼Œæ›´æ˜“äºç®¡ç†å’Œä¿®æ”¹
- **æ— éœ€å®ä¾‹åŒ–å³å¯è¯»å–**: æ¡†æ¶æ— éœ€å®ä¾‹åŒ–æ’ä»¶ç±»å³å¯è·å–å…ƒæ•°æ®ï¼Œæå‡æ€§èƒ½
- **ä¾èµ–ç®¡ç†**: æ”¯æŒå£°æ˜å¼çš„ä¾èµ–å…³ç³»å’Œç‰ˆæœ¬èŒƒå›´
- **æ ‡å‡†åŒ–**: å‚è€ƒ npm çš„ package.jsonï¼Œé‡‡ç”¨ä¸šç•Œæ ‡å‡†å‘½åè§„èŒƒ

### å®Œæ•´é…ç½®ç¤ºä¾‹

```json
{
  "name": "com.company.pluginname",
  "displayName": "æ’ä»¶æ˜¾ç¤ºåç§°",
  "version": "1.0.0",
  "description": "æ’ä»¶çš„è¯¦ç»†æè¿°",
  "author": "ä½œè€…å§“å <email@example.com>",
  "license": "MIT",
  "homepage": "https://github.com/user/plugin",
  
  "main": "PluginName.dll",
  "entryClass": "Namespace.PluginClassName",
  
  "dependencies": {
    "com.other.plugin": "^2.0.0"
  },
  
  "engines": "0.0.1.0"
}
```

### å­—æ®µè¯¦ç»†è¯´æ˜

#### å¿…éœ€å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `name` | string | **æ’ä»¶å”¯ä¸€æ ‡è¯†ç¬¦**ï¼Œä½¿ç”¨åå‘åŸŸåæ ¼å¼ | `"com.example.testplugin"` |
| `version` | string | **è¯­ä¹‰åŒ–ç‰ˆæœ¬å·** (Semveræ ¼å¼) | `"1.0.0"` |
| `main` | string | **ä¸» DLL æ–‡ä»¶å** | `"TestPlugin.dll"` |
| `entryClass` | string | **å…¥å£ç±»çš„å®Œå…¨é™å®šå** | `"Test.TestPlugin"` |

#### å¯é€‰å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `displayName` | string | æ˜¾ç¤ºç»™ç”¨æˆ·çš„å‹å¥½åç§°ï¼Œé»˜è®¤ä¸º `name` | `"æµ‹è¯•æ’ä»¶"` |
| `description` | string | æ’ä»¶çš„è¯¦ç»†æè¿° | `"è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ’ä»¶"` |
| `author` | string | ä½œè€…ä¿¡æ¯ | `"John Doe <john@example.com>"` |
| `license` | string | å¼€æºè®¸å¯è¯ | `"MIT"` |
| `homepage` | string | æ’ä»¶ä¸»é¡µ URL | `"https://github.com/..."` |
| `dependencies` | object | æ’ä»¶ä¾èµ–ï¼ˆé”®ä¸ºæ’ä»¶åï¼Œå€¼ä¸ºç‰ˆæœ¬èŒƒå›´ï¼‰ | `{"com.other.plugin": "^1.0.0"}` |
| `engine` | string | è¿è¡Œç¯å¢ƒæœ€ä½è¦æ±‚ | `"1.0.0.0"` |

### name å­—æ®µå‘½åè§„èŒƒ

**æ ¼å¼**: `com.company.pluginname`

**è§„åˆ™**:
- ä½¿ç”¨åå‘åŸŸåæ ¼å¼ï¼ˆç±»ä¼¼ Java åŒ…åï¼‰
- åªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—ã€ç‚¹ `.` å’Œè¿å­—ç¬¦ `-`
- æ¯ä¸ªéƒ¨åˆ†å¿…é¡»ä»¥å­—æ¯å¼€å¤´
- è‡³å°‘åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼ˆç”¨ç‚¹åˆ†éš”ï¼‰

**ç¤ºä¾‹**:
- âœ… `com.microdock.test`
- âœ… `com.example.weather-plugin`
- âœ… `org.mycompany.tool`
- âŒ `TestPlugin` ï¼ˆä¸ç¬¦åˆåå‘åŸŸåæ ¼å¼ï¼‰
- âŒ `com.Example.Plugin` ï¼ˆåŒ…å«å¤§å†™å­—æ¯ï¼‰
- âŒ `com.123company.plugin` ï¼ˆæ•°å­—å¼€å¤´ï¼‰

### version å­—æ®µç‰ˆæœ¬æ ¼å¼

**æ ¼å¼**: `ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.è¡¥ä¸ç‰ˆæœ¬[-é¢„å‘å¸ƒç‰ˆæœ¬][+æ„å»ºå…ƒæ•°æ®]`

**ç¤ºä¾‹**:
- `1.0.0` - æ­£å¼ç‰ˆæœ¬
- `2.3.1` - æ ‡å‡†ç‰ˆæœ¬
- `1.0.0-alpha` - é¢„å‘å¸ƒç‰ˆæœ¬
- `1.0.0-beta.1` - å¸¦åºå·çš„é¢„å‘å¸ƒç‰ˆæœ¬
- `1.0.0+20231113` - å¸¦æ„å»ºå…ƒæ•°æ®çš„ç‰ˆæœ¬

### dependencies ä¾èµ–ç®¡ç†

#### ç‰ˆæœ¬èŒƒå›´è¯­æ³•

| æ ¼å¼ | è¯´æ˜ | åŒ¹é…ç¤ºä¾‹ |
|------|------|----------|
| `1.0.0` | ç²¾ç¡®ç‰ˆæœ¬ | åªåŒ¹é… `1.0.0` |
| `^1.0.0` | å…¼å®¹ç‰ˆæœ¬ï¼ˆä¸»ç‰ˆæœ¬ç›¸åŒï¼‰ | `1.0.0` ~ `1.x.x` |
| `~1.0.0` | è¡¥ä¸ç‰ˆæœ¬ï¼ˆä¸»æ¬¡ç‰ˆæœ¬ç›¸åŒï¼‰ | `1.0.0` ~ `1.0.x` |
| `>=1.0.0` | æœ€ä½ç‰ˆæœ¬ | `1.0.0` åŠä»¥ä¸Š |
| `*` | ä»»æ„ç‰ˆæœ¬ | ä»»ä½•ç‰ˆæœ¬ |

#### ä¾èµ–ç¤ºä¾‹

```json
{
  "dependencies": {
    "com.base.plugin": "^2.0.0",      // å…¼å®¹ 2.x.x ç‰ˆæœ¬
    "com.utils.plugin": "~1.5.0",     // å…¼å®¹ 1.5.x ç‰ˆæœ¬
    "com.required.plugin": ">=3.0.0", // 3.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
    "com.any.plugin": "*"              // ä»»æ„ç‰ˆæœ¬
  }
}
```

### æœ€å°é…ç½®ç¤ºä¾‹

ä¸€ä¸ªæœ€ç®€å•çš„ `plugin.json` ç¤ºä¾‹ï¼š

```json
{
  "name": "com.example.myplugin",
  "version": "1.0.0",
  "main": "MyPlugin.dll",
  "entryClass": "MyPlugin.MyPluginClass"
}
```

### é¡¹ç›®é…ç½®

åœ¨ `.csproj` æ–‡ä»¶ä¸­é…ç½®è‡ªåŠ¨å¤åˆ¶ `plugin.json`ï¼š

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\MicroDock.Plugin\MicroDock.Plugin.csproj" />
  </ItemGroup>

  <!-- è‡ªåŠ¨å¤åˆ¶ plugin.json åˆ°è¾“å‡ºç›®å½• -->
  <ItemGroup>
    <None Update="plugin.json">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>
</Project>
```

---

## å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»ºæ’ä»¶é¡¹ç›®

```bash
# åˆ›å»ºæ–°çš„ç±»åº“é¡¹ç›®
dotnet new classlib -n MyMicroDockPlugin -f net8.0

# æ·»åŠ å¯¹ MicroDock.Plugin çš„å¼•ç”¨
cd MyMicroDockPlugin
dotnet add reference path/to/MicroDock.Plugin.csproj

# æ·»åŠ  Avalonia UI ä¾èµ–ï¼ˆå¦‚æœéœ€è¦åˆ›å»º UIï¼‰
dotnet add package Avalonia --version 11.3.8
```

### 2. åˆ›å»º plugin.json

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `plugin.json` æ–‡ä»¶ï¼š

```json
{
  "name": "com.mycompany.myplugin",
  "displayName": "æˆ‘çš„æ’ä»¶",
  "version": "1.0.0",
  "description": "è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ’ä»¶",
  "author": "Your Name <your.email@example.com>",
  "license": "MIT",
  
  "main": "MyMicroDockPlugin.dll",
  "entryClass": "MyMicroDockPlugin.MyPlugin",
  
  "engines": "0.0.2.0"
}
```

### 3. å®ç°æ’ä»¶æ¥å£

åˆ›å»ºä¸»æ’ä»¶ç±»å¹¶å®ç° `IMicroDockPlugin` æ¥å£ï¼š

```csharp
using MicroDock.Plugin;

public class MyPlugin : BaseMicroDockPlugin
{
    // æ’ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
    public override void OnInit()
    {
        base.OnInit();
        // æ’ä»¶åˆå§‹åŒ–é€»è¾‘
        Context!.LogInfo("æˆ‘çš„æ’ä»¶å·²åˆå§‹åŒ–");
    }

    public override void OnEnable()
    {
        base.OnEnable();
        Context!.LogInfo("æˆ‘çš„æ’ä»¶å·²å¯ç”¨");
    }

    public override void OnDisable()
    {
        base.OnDisable();
        Context!.LogInfo("æˆ‘çš„æ’ä»¶å·²ç¦ç”¨");
    }

    public override void OnDestroy()
    {
        base.OnDestroy();
        // æ’ä»¶æ¸…ç†é€»è¾‘
        Context!.LogInfo("æˆ‘çš„æ’ä»¶æ­£åœ¨é”€æ¯");
    }
    
    // æ’ä»¶æ ‡ç­¾é¡µé…ç½®
    public override IMicroTab[] Tabs => Array.Empty<IMicroTab>();
}
```

### 4. æ·»åŠ æ ‡ç­¾é¡µï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨çš„æ’ä»¶éœ€è¦æä¾› UI ç•Œé¢ï¼Œåˆ›å»ºä¸€ä¸ªæ ‡ç­¾é¡µè§†å›¾å¹¶åœ¨ `Tabs` å±æ€§ä¸­è¿”å›ï¼š

**MyTabView.axaml**:
```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="MyMicroDockPlugin.MyTabView">
    <StackPanel Margin="0,12,12,12" Spacing="8">
        <TextBlock Text="æˆ‘çš„æ ‡ç­¾é¡µ" FontSize="16" FontWeight="Bold"/>
        <TextBox Watermark="è¾“å…¥å†…å®¹..."/>
        <Button Content="æäº¤"/>
    </StackPanel>
</UserControl>
```

**å®ç° IMicroTab æ¥å£çš„ View ç±»**:
```csharp
// MyTabView.axaml.cs
using Avalonia.Controls;
using MicroDock.Plugin;

public partial class MyTabView : UserControl, IMicroTab
{
    public string TabName => "æˆ‘çš„æ ‡ç­¾é¡µ";
    public IconSymbolEnum IconSymbol => IconSymbolEnum.GamesFilled;
    
    public MyTabView()
    {
        InitializeComponent();
    }
}
```

**æ›´æ–°æ’ä»¶ç±»**:
```csharp
public class MyPlugin : BaseMicroDockPlugin
{
    private MyTabView? _tabView;
    
    public override IMicroTab[] Tabs
    {
        get
        {
            if (_tabView == null)
            {
                _tabView = new MyTabView();
            }
            return new IMicroTab[] { _tabView };
        }
    }
}
```

### 5. é…ç½®é¡¹ç›®æ–‡ä»¶

æ›´æ–° `.csproj` æ–‡ä»¶ï¼Œç¡®ä¿ `plugin.json` è¢«å¤åˆ¶åˆ°è¾“å‡ºç›®å½•ï¼š

```xml
<ItemGroup>
  <None Update="plugin.json">
    <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
  </None>
</ItemGroup>
```

### 6. ç¼–è¯‘å’Œéƒ¨ç½²

```bash
# ç¼–è¯‘æ’ä»¶
dotnet build -c Release

# å°†ç”Ÿæˆçš„æ–‡ä»¶å¤åˆ¶åˆ° MicroDock çš„ Plugins/PluginName ç›®å½•
# æ³¨æ„ï¼šæ¯ä¸ªæ’ä»¶éœ€è¦åœ¨ç‹¬ç«‹çš„å­æ–‡ä»¶å¤¹ä¸­
mkdir -p path/to/MicroDock/Plugins/MyPlugin
cp bin/Release/net8.0/* path/to/MicroDock/Plugins/MyPlugin/
```

**é‡è¦**: æ’ä»¶å¿…é¡»æ”¾åœ¨ `Plugins` ç›®å½•ä¸‹çš„ç‹¬ç«‹å­æ–‡ä»¶å¤¹ä¸­ï¼Œæ–‡ä»¶å¤¹åç§°å»ºè®®ä¸æ’ä»¶åç§°ä¸€è‡´ã€‚

---

## æ’ä»¶æ¥å£

### IMicroDockPluginï¼ˆæ ¸å¿ƒæ¥å£ï¼‰

æ‰€æœ‰æ’ä»¶å¿…é¡»å®ç°çš„åŸºç¡€æ¥å£ï¼š

```csharp
public interface IMicroDockPlugin
{
    /// <summary>
    /// åˆå§‹åŒ–æ’ä»¶ä¸Šä¸‹æ–‡ï¼ˆç”±æ¡†æ¶è°ƒç”¨ï¼Œä¹‹åä¼šè°ƒç”¨ OnInitï¼‰
    /// </summary>
    void Initialize(IPluginContext context);

    /// <summary>
    /// æ‰€æœ‰æ ‡ç­¾é¡µ
    /// </summary>
    IMicroTab[] Tabs { get; }

    /// <summary>
    /// è·å–æ’ä»¶çš„è®¾ç½®UIæ§ä»¶ï¼ˆå¯é€‰ï¼Œè¿”å›nullè¡¨ç¤ºæ²¡æœ‰è®¾ç½®ï¼‰
    /// </summary>
    object? GetSettingsControl();

    /// <summary>
    /// æ’ä»¶åˆå§‹åŒ–
    /// </summary>
    void OnInit();

    /// <summary>
    /// å¼‚æ­¥åˆå§‹åŒ–(å¯é€‰)
    /// </summary>
    Task OnInitAsync();

    /// <summary>
    /// æ‰€æœ‰æ’ä»¶åˆå§‹åŒ–å®Œæˆåè°ƒç”¨
    /// </summary>
    void OnAllPluginsLoaded();

    /// <summary>
    /// æ’ä»¶å¯ç”¨
    /// </summary>
    void OnEnable();

    /// <summary>
    /// æ’ä»¶ç¦ç”¨
    /// </summary>
    void OnDisable();

    /// <summary>
    /// æ’ä»¶é‡Šæ”¾
    /// </summary>
    void OnDestroy();
}
```

### IMicroTabï¼ˆæ ‡ç­¾é¡µæ¥å£ï¼‰

ç”¨äºå‘ä¸»åº”ç”¨æ·»åŠ æ–°çš„æ ‡ç­¾é¡µï¼š

```csharp
public interface IMicroTab
{
    /// <summary>
    /// é¡µç­¾åå­—
    /// </summary>
    string TabName { get; }
    
    /// <summary>
    /// é¡µç­¾å›¾æ ‡
    /// </summary>
    IconSymbolEnum IconSymbol { get; }
}
```

**é‡è¦è¯´æ˜**ï¼š
- å®ç° `IMicroTab` æ¥å£çš„ç±»é€šå¸¸æ˜¯ä¸€ä¸ª `UserControl`ï¼Œè¯¥æ§ä»¶æœ¬èº«å°±æ˜¯æ ‡ç­¾é¡µçš„å†…å®¹
- `IconSymbolEnum` æä¾›äº†å¤§é‡é¢„å®šä¹‰çš„å›¾æ ‡ç¬¦å·ï¼ˆå¦‚ `GamesFilled`ã€`FolderFilled`ã€`Settings` ç­‰ï¼‰
- å®Œæ•´çš„å›¾æ ‡åˆ—è¡¨è¯·å‚è€ƒ `MicroDock.Plugin.IconSymbolEnum` æšä¸¾

---

## æ’ä»¶å·¥å…·ç³»ç»Ÿ

### ğŸ†• å…¨æ–°åŠŸèƒ½ï¼ˆv0.0.3.0+ï¼‰

ä» MicroDock v0.0.3.0 å¼€å§‹ï¼Œæ’ä»¶ç³»ç»Ÿå¼•å…¥äº†**å·¥å…·è°ƒç”¨ç³»ç»Ÿ**ï¼Œå…è®¸æ’ä»¶ä¹‹é—´é€šè¿‡å·¥å…·åå’Œå‚æ•°ç›¸äº’è°ƒç”¨åŠŸèƒ½ï¼Œç±»ä¼¼äº MCP (Model Context Protocol) çš„è®¾è®¡ç†å¿µã€‚

### å·¥å…·ç³»ç»Ÿç‰¹æ€§

- âœ… **åŸºäºç‰¹æ€§å®šä¹‰**: ä½¿ç”¨ `[MicroTool]` ç‰¹æ€§æ ‡è®°æ–¹æ³•
- âœ… **å¼ºç±»å‹å‚æ•°**: æ”¯æŒåŸºæœ¬ç±»å‹ã€å¤æ‚å¯¹è±¡ã€æ³›å‹ç­‰å„ç§å‚æ•°ç±»å‹
- âœ… **è‡ªåŠ¨ç±»å‹è½¬æ¢**: æ¡†æ¶è‡ªåŠ¨å¤„ç†ç±»å‹è½¬æ¢å’Œ JSON åºåˆ—åŒ–
- âœ… **æ’ä»¶åé™å®š**: å¯æŒ‡å®šè°ƒç”¨ç‰¹å®šæ’ä»¶çš„å·¥å…·
- âœ… **å·¥å…·å‘ç° API**: æŸ¥è¯¢æ‰€æœ‰å¯ç”¨å·¥å…·åŠå…¶è¯¦ç»†ä¿¡æ¯
- âœ… **å®Œæ•´æ–‡æ¡£**: å·¥å…·å’Œå‚æ•°çš„è¯¦ç»†æè¿°
- âœ… **å¼‚æ­¥æ‰§è¡Œ**: æ‰€æœ‰å·¥å…·è°ƒç”¨éƒ½æ˜¯å¼‚æ­¥çš„
- âœ… **æ—¥å¿—å’Œç»Ÿè®¡**: è‡ªåŠ¨è®°å½•å·¥å…·è°ƒç”¨å’Œä½¿ç”¨ç»Ÿè®¡

### å®šä¹‰å·¥å…·

#### åŸºæœ¬å·¥å…·ç¤ºä¾‹

```csharp
using MicroDock.Plugin;
using System.Threading.Tasks;

public class MyPlugin : BaseMicroDockPlugin
{
    /// <summary>
    /// ç®€å•çš„å­—ç¬¦ä¸²åè½¬å·¥å…·
    /// </summary>
    [MicroTool("string.reverse",
        Description = "åè½¬è¾“å…¥çš„å­—ç¬¦ä¸²",
        ReturnDescription = "åè½¬åçš„å­—ç¬¦ä¸²")]
    public async Task<string> ReverseString(
        [ToolParameter("input", Description = "è¦åè½¬çš„å­—ç¬¦ä¸²")] 
        string input)
    {
        await Task.CompletedTask;
        return new string(input.Reverse().ToArray());
    }
}
```

#### å¤æ‚å‚æ•°å·¥å…·ç¤ºä¾‹

```csharp
/// <summary>
/// å¤„ç†å¤æ‚æ•°æ®å¯¹è±¡
/// </summary>
[MicroTool("data.filter",
    Description = "è¿‡æ»¤æ•°æ®åˆ—è¡¨",
    ReturnDescription = "è¿‡æ»¤åçš„æ•°æ® JSON")]
public async Task<string> FilterData(
    [ToolParameter("items", Description = "æ•°æ®åˆ—è¡¨")] 
    List<MyDataModel> items,
    [ToolParameter("minValue", Description = "æœ€å°å€¼", Required = false)] 
    int minValue = 0)
{
    await Task.CompletedTask;
    var filtered = items.Where(x => x.Value >= minValue).ToList();
    return System.Text.Json.JsonSerializer.Serialize(filtered);
}
```

### å·¥å…·ç‰¹æ€§è¯¦è§£

#### MicroToolAttribute

```csharp
[MicroTool("tool.name",
    Description = "å·¥å…·çš„è¯¦ç»†æè¿°",
    ReturnDescription = "è¿”å›å€¼çš„è¯´æ˜")]
```

- **name**: å·¥å…·çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆå»ºè®®ä½¿ç”¨ `category.action` æ ¼å¼ï¼‰
- **Description**: å·¥å…·åŠŸèƒ½çš„è¯¦ç»†æè¿°
- **ReturnDescription**: è¿”å›å€¼çš„è¯´æ˜

#### ToolParameterAttribute

```csharp
[ToolParameter("paramName",
    Description = "å‚æ•°çš„è¯¦ç»†æè¿°",
    Required = true)]
```

- **name**: å‚æ•°åç§°
- **Description**: å‚æ•°çš„è¯¦ç»†è¯´æ˜
- **Required**: æ˜¯å¦ä¸ºå¿…éœ€å‚æ•°ï¼ˆæœ‰é»˜è®¤å€¼æ—¶è‡ªåŠ¨ä¸º falseï¼‰

### å·¥å…·æ–¹æ³•çš„ç±»å‹

MicroDock å·¥å…·ç³»ç»Ÿæ”¯æŒä¸‰ç§ç±»å‹çš„å·¥å…·æ–¹æ³•ï¼Œæ¯ç§ç±»å‹éƒ½æœ‰å…¶ç‰¹å®šçš„ä½¿ç”¨åœºæ™¯å’Œæ€§èƒ½ç‰¹å¾ï¼š

#### 1. é™æ€æ–¹æ³•å·¥å…· âš¡

**ç‰¹ç‚¹**:
- æ— éœ€å®ä¾‹ï¼Œç›´æ¥è°ƒç”¨
- æ€§èƒ½æœ€ä¼˜ï¼Œæ— å®ä¾‹åˆ›å»ºå¼€é”€
- æ— æ³•ç»´æŠ¤çŠ¶æ€

**é€‚ç”¨åœºæ™¯**:
- æ— çŠ¶æ€çš„çº¯å‡½æ•°å·¥å…·
- å·¥å…·å‡½æ•°ã€è®¡ç®—ã€è½¬æ¢ç­‰æ“ä½œ
- æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯

**ç¤ºä¾‹**:

```csharp
/// <summary>
/// é™æ€æ–¹æ³•å·¥å…·ç¤ºä¾‹ï¼šæ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
/// </summary>
[MicroTool("test.static_format_date",
    Description = "é™æ€æ–¹æ³•ï¼šæ ¼å¼åŒ–å½“å‰æ—¥æœŸæ—¶é—´",
    ReturnDescription = "æ ¼å¼åŒ–åçš„æ—¥æœŸæ—¶é—´å­—ç¬¦ä¸²")]
public static async Task<string> FormatCurrentDate(
    [ToolParameter("format", Description = "æ—¥æœŸæ ¼å¼", Required = false)] 
    string format = "yyyy-MM-dd HH:mm:ss")
{
    await Task.CompletedTask;
    return DateTime.Now.ToString(format);
}
```

**ä¼˜ç‚¹**:
- âœ… æ€§èƒ½æœ€ä¼˜ï¼Œæ— é¢å¤–å¼€é”€
- âœ… çº¿ç¨‹å®‰å…¨ï¼ˆæ— çŠ¶æ€ï¼‰
- âœ… ç®€å•ç›´è§‚

**é™åˆ¶**:
- âŒ æ— æ³•è®¿é—®æ’ä»¶å®ä¾‹çš„çŠ¶æ€
- âŒ æ— æ³•ä½¿ç”¨æ’ä»¶çš„ä¸Šä¸‹æ–‡å’ŒæœåŠ¡

#### 2. æ’ä»¶ç±»å®ä¾‹æ–¹æ³•å·¥å…· ğŸ”Œ

**ç‰¹ç‚¹**:
- ä½¿ç”¨æ’ä»¶å·²æœ‰å®ä¾‹
- æ€§èƒ½ä¼˜ï¼Œæ— é¢å¤–å¼€é”€
- å¯ä»¥è®¿é—®æ’ä»¶çŠ¶æ€å’Œèµ„æº

**é€‚ç”¨åœºæ™¯**:
- éœ€è¦è®¿é—®æ’ä»¶çŠ¶æ€æˆ–é…ç½®
- éœ€è¦ä½¿ç”¨æ’ä»¶ä¸Šä¸‹æ–‡æœåŠ¡
- ä¸æ’ä»¶åŠŸèƒ½ç´§å¯†è€¦åˆçš„æ“ä½œ

**ç¤ºä¾‹**:

```csharp
public class MyPlugin : BaseMicroDockPlugin
{
    private int _pluginState = 0;

    [MicroTool("plugin.instance_tool",
        Description = "æ’ä»¶å®ä¾‹æ–¹æ³•ç¤ºä¾‹",
        ReturnDescription = "å¤„ç†ç»“æœ")]
    public async Task<string> InstanceTool(
        [ToolParameter("param", Description = "å‚æ•°")] string param)
    {
        // å¯ä»¥è®¿é—®æ’ä»¶å®ä¾‹çš„å­—æ®µå’Œå±æ€§
        _pluginState++;
        Context!.LogInfo($"å¤„ç†å‚æ•°: {param}, çŠ¶æ€: {_pluginState}");
        
        // å¯ä»¥ä½¿ç”¨æ’ä»¶ä¸Šä¸‹æ–‡
        var config = GetSettings("config_key");
        
        return await Task.FromResult($"å¤„ç†å®Œæˆ: {param}");
    }
}
```

**ä¼˜ç‚¹**:
- âœ… æ— é¢å¤–å®ä¾‹åˆ›å»ºå¼€é”€
- âœ… å¯ä»¥è®¿é—®æ’ä»¶çŠ¶æ€å’Œé…ç½®
- âœ… å¯ä»¥ä½¿ç”¨æ’ä»¶ä¸Šä¸‹æ–‡æœåŠ¡

**é™åˆ¶**:
- âŒ ä»…é™äºæ’ä»¶ç±»æœ¬èº«çš„æ–¹æ³•

#### 3. å…¶ä»–ç±»å®ä¾‹æ–¹æ³•å·¥å…· âš ï¸

**ç‰¹ç‚¹**:
- é¦–æ¬¡è°ƒç”¨æ—¶åˆ›å»ºå®ä¾‹ï¼Œåç»­å¤ç”¨
- æ€§èƒ½ï¼šé¦–æ¬¡è°ƒç”¨æœ‰åˆ›å»ºå¼€é”€ï¼Œåç»­æ­£å¸¸
- å¯ä»¥ç»´æŠ¤å·¥å…·çš„ç‹¬ç«‹çŠ¶æ€
- **UI æ ‡è¯†**: è®¾ç½®ç•Œé¢ä¸­æ˜¾ç¤ºé»„è‰²è­¦å‘Šæ¡† "âš ï¸ é¦–æ¬¡è°ƒç”¨åˆ›å»ºå®ä¾‹ï¼Œåç»­å¤ç”¨"

**é€‚ç”¨åœºæ™¯**:
- éœ€è¦çŠ¶æ€ç®¡ç†çš„è¾…åŠ©å·¥å…·
- å·¥å…·é€»è¾‘ä¸æ’ä»¶ä¸»ç±»è§£è€¦
- éœ€è¦å¤æ‚çŠ¶æ€ç»´æŠ¤çš„å·¥å…·é›†

**ç¤ºä¾‹**:

```csharp
/// <summary>
/// è¾…åŠ©ç±»å·¥å…·ç¤ºä¾‹ï¼ˆæ¼”ç¤ºå®ä¾‹å¤ç”¨å’ŒçŠ¶æ€ç®¡ç†ï¼‰
/// </summary>
internal class TestHelper
{
    private int _callCount = 0;
    private readonly List<string> _history = new();

    /// <summary>
    /// å·¥å…·ï¼šè·å–è°ƒç”¨æ¬¡æ•°ï¼ˆæ¼”ç¤ºå®ä¾‹å¤ç”¨ï¼‰
    /// </summary>
    [MicroTool("test.helper_count",
        Description = "è¿”å›æ­¤å·¥å…·å®ä¾‹çš„è°ƒç”¨æ¬¡æ•°ï¼ˆæ¼”ç¤ºå®ä¾‹å¤ç”¨ï¼‰",
        ReturnDescription = "è°ƒç”¨æ¬¡æ•°")]
    public async Task<string> GetCallCount()
    {
        await Task.CompletedTask;
        _callCount++;
        return $"æ­¤å®ä¾‹å·²è¢«è°ƒç”¨ {_callCount} æ¬¡";
    }

    /// <summary>
    /// å·¥å…·ï¼šè®°å½•æ“ä½œå†å²
    /// </summary>
    [MicroTool("test.helper_reverse",
        Description = "åè½¬å­—ç¬¦ä¸²å¹¶è®°å½•å†å²",
        ReturnDescription = "åè½¬åçš„å­—ç¬¦ä¸²")]
    public async Task<string> ReverseString(
        [ToolParameter("text", Description = "è¦åè½¬çš„å­—ç¬¦ä¸²")] string text)
    {
        await Task.CompletedTask;
        var reversed = new string(text.Reverse().ToArray());
        _history.Add($"åè½¬: {text} -> {reversed}");
        return reversed;
    }

    /// <summary>
    /// å·¥å…·ï¼šè·å–æ“ä½œå†å²
    /// </summary>
    [MicroTool("test.helper_history",
        Description = "è·å–æ‰€æœ‰æ“ä½œå†å²",
        ReturnDescription = "å†å²è®°å½•ï¼ˆJSON æ•°ç»„ï¼‰")]
    public async Task<string> GetHistory()
    {
        await Task.CompletedTask;
        return System.Text.Json.JsonSerializer.Serialize(_history);
    }
}
```

**ä¼˜ç‚¹**:
- âœ… å®ä¾‹å¤ç”¨ï¼Œé¿å…é‡å¤åˆ›å»º
- âœ… å¯ä»¥ç»´æŠ¤å·¥å…·çš„ç‹¬ç«‹çŠ¶æ€
- âœ… å·¥å…·é€»è¾‘è§£è€¦ï¼Œæ˜“äºç»„ç»‡

**é™åˆ¶**:
- âŒ é¦–æ¬¡è°ƒç”¨æœ‰åˆ›å»ºå¼€é”€
- âš ï¸ éœ€è¦æœ‰æ— å‚æ„é€ å‡½æ•°ï¼ˆå¯ä»¥æ˜¯ private æˆ– internalï¼‰
- âš ï¸ å®ä¾‹åœ¨æ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…å­˜åœ¨ï¼Œæ³¨æ„çŠ¶æ€ç´¯ç§¯

**æ³¨æ„äº‹é¡¹**:
1. **æ„é€ å‡½æ•°è¦æ±‚**: éæ’ä»¶ç±»å¿…é¡»æœ‰æ— å‚æ„é€ å‡½æ•°ï¼ˆå¯ä»¥æ˜¯ private æˆ– internalï¼‰
2. **çº¿ç¨‹å®‰å…¨**: å®ä¾‹åˆ›å»ºæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†å·¥å…·æ–¹æ³•æœ¬èº«éœ€è¦è‡ªè¡Œä¿è¯çº¿ç¨‹å®‰å…¨
3. **çŠ¶æ€ç®¡ç†**: å®ä¾‹åœ¨æ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…å¤ç”¨ï¼Œæ³¨æ„çŠ¶æ€ç´¯ç§¯å’Œå†…å­˜ä½¿ç”¨
4. **UI æç¤º**: è®¾ç½®ç•Œé¢ä¼šè‡ªåŠ¨æ˜¾ç¤ºé»„è‰²è­¦å‘Šæ ‡è¯†æ­¤ç±»å·¥å…·

#### æ€§èƒ½å¯¹æ¯”

| å·¥å…·ç±»å‹ | é¦–æ¬¡è°ƒç”¨ | åç»­è°ƒç”¨ | çŠ¶æ€ç»´æŠ¤ | é€‚ç”¨åœºæ™¯ |
|---------|---------|---------|---------|---------|
| é™æ€æ–¹æ³• | âš¡ æœ€å¿« | âš¡ æœ€å¿« | âŒ ä¸æ”¯æŒ | æ— çŠ¶æ€çº¯å‡½æ•° |
| æ’ä»¶å®ä¾‹æ–¹æ³• | âš¡ å¿« | âš¡ å¿« | âœ… æ’ä»¶çŠ¶æ€ | ä¸æ’ä»¶è€¦åˆçš„æ“ä½œ |
| å…¶ä»–ç±»å®ä¾‹æ–¹æ³• | ğŸ¢ ç¨æ…¢ | âš¡ å¿« | âœ… ç‹¬ç«‹çŠ¶æ€ | éœ€è¦çŠ¶æ€çš„è¾…åŠ©å·¥å…· |

#### é€‰æ‹©å»ºè®®

1. **ä¼˜å…ˆä½¿ç”¨é™æ€æ–¹æ³•**ï¼Œé™¤ééœ€è¦çŠ¶æ€ç®¡ç†
2. **éœ€è¦æ’ä»¶çŠ¶æ€æ—¶ä½¿ç”¨æ’ä»¶å®ä¾‹æ–¹æ³•**
3. **éœ€è¦ç‹¬ç«‹çŠ¶æ€ç®¡ç†æ—¶ä½¿ç”¨å…¶ä»–ç±»å®ä¾‹æ–¹æ³•**
4. **æ€§èƒ½æ•æ„Ÿåœºæ™¯ä¼˜å…ˆé€‰æ‹©é™æ€æ–¹æ³•**

### è°ƒç”¨å·¥å…·

#### åœ¨ OnAllPluginsLoaded ä¸­è°ƒç”¨

```csharp
public override void OnAllPluginsLoaded()
{
    base.OnAllPluginsLoaded();
    
    // ç­‰æ‰€æœ‰æ’ä»¶åŠ è½½å®Œæˆåæ‰èƒ½å®‰å…¨åœ°è°ƒç”¨å…¶ä»–æ’ä»¶çš„å·¥å…·
    
    // 1. è°ƒç”¨å…¨å±€å·¥å…·ï¼ˆè°ƒç”¨ç¬¬ä¸€ä¸ªåŒ¹é…çš„ï¼‰
    var result1 = await CallToolAsync("string.reverse", new Dictionary<string, string>
    {
        ["input"] = "Hello World"
    });
    
    // 2. æŒ‡å®šæ’ä»¶åè°ƒç”¨
    var result2 = await CallToolAsync("math.add", new Dictionary<string, string>
    {
        ["a"] = "10",
        ["b"] = "20"
    }, pluginName: "com.microdock.test");
    
    // 3. å¤æ‚å¯¹è±¡å‚æ•°ï¼ˆéœ€è¦åºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²ï¼‰
    var items = new List<MyDataModel> { /* ... */ };
    var itemsJson = System.Text.Json.JsonSerializer.Serialize(items);
    var result3 = await CallToolAsync("data.filter", new Dictionary<string, string>
    {
        ["items"] = itemsJson,  // å¤æ‚å¯¹è±¡éœ€è¦å…ˆåºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²
        ["minValue"] = "10"
    });
}
```

### å·¥å…·å‘ç°

```csharp
public override void OnAllPluginsLoaded()
{
    base.OnAllPluginsLoaded();
    
    // è·å–æ‰€æœ‰å¯ç”¨å·¥å…·
    var allTools = GetAvailableTools();
    foreach (var tool in allTools)
    {
        Context!.LogInfo($"å·¥å…·: {tool.Name}");
        Context!.LogInfo($"  æè¿°: {tool.Description}");
        Context!.LogInfo($"  æä¾›è€…: {tool.ProviderPlugin}");
        Context!.LogInfo($"  å‚æ•°: {tool.ParametersSummary}");
    }
    
    // è·å–æŒ‡å®šæ’ä»¶çš„å·¥å…·
    var pluginTools = GetPluginTools("com.microdock.test");
    
    // è·å–å·¥å…·è¯¦ç»†ä¿¡æ¯
    var toolInfo = GetToolInfo("string.reverse");
    if (toolInfo != null)
    {
        Context!.LogInfo($"è¿”å›å€¼: {toolInfo.ReturnDescription}");
        foreach (var param in toolInfo.Parameters)
        {
            Context!.LogInfo($"  å‚æ•°: {param.Name} ({param.TypeName})");
            Context!.LogInfo($"    æè¿°: {param.Description}");
            Context!.LogInfo($"    å¿…éœ€: {param.Required}");
        }
    }
}
```

### æ”¯æŒçš„å‚æ•°ç±»å‹

å·¥å…·æ–¹æ³•å¯ä»¥æ¥å—ä»¥ä¸‹ç±»å‹çš„å‚æ•°ï¼ˆè°ƒç”¨æ—¶éƒ½ä»¥å­—ç¬¦ä¸²å½¢å¼ä¼ é€’ï¼Œæ¡†æ¶è‡ªåŠ¨è½¬æ¢ï¼‰ï¼š

#### åŸºæœ¬ç±»å‹
```csharp
int, string, bool, double, float, long, decimal, byte, short, char
```

**è°ƒç”¨ç¤ºä¾‹**ï¼š
```csharp
new Dictionary<string, string>
{
    ["age"] = "25",           // int
    ["name"] = "John",        // string
    ["active"] = "true",      // bool
    ["price"] = "19.99"       // double
}
```

#### å¯ç©ºç±»å‹
```csharp
int?, string?, bool?, double? ç­‰
```

**è°ƒç”¨ç¤ºä¾‹**ï¼š
```csharp
new Dictionary<string, string>
{
    ["optionalAge"] = "25",   // int? (æœ‰å€¼)
    ["optionalName"] = "",    // string? (ç©ºå­—ç¬¦ä¸²è¡¨ç¤º null)
}
```

#### é›†åˆç±»å‹
```csharp
List<T>, Dictionary<TKey, TValue>, T[]
```

**è°ƒç”¨ç¤ºä¾‹**ï¼š
```csharp
var items = new List<string> { "item1", "item2", "item3" };
var itemsJson = System.Text.Json.JsonSerializer.Serialize(items);

new Dictionary<string, string>
{
    ["items"] = itemsJson  // éœ€è¦åºåˆ—åŒ–ä¸º JSON
}
```

#### å¤æ‚ç±»å‹
ä»»ä½•å¯ JSON åºåˆ—åŒ–çš„ç±»å‹ï¼š

```csharp
public class MyDataModel
{
    public string Name { get; set; }
    public int Value { get; set; }
}
```

**è°ƒç”¨ç¤ºä¾‹**ï¼š
```csharp
var data = new MyDataModel { Name = "Test", Value = 100 };
var dataJson = System.Text.Json.JsonSerializer.Serialize(data);

new Dictionary<string, string>
{
    ["data"] = dataJson  // éœ€è¦åºåˆ—åŒ–ä¸º JSON
}
```

### ç±»å‹è½¬æ¢æœºåˆ¶

æ¡†æ¶ä¼šè‡ªåŠ¨å¤„ç†å‚æ•°ç±»å‹è½¬æ¢ã€‚ç”±äº `CallToolAsync` æ¥å— `Dictionary<string, string>` å‚æ•°ï¼Œæ‰€ä»¥ï¼š

1. **å­—ç¬¦ä¸²å‚æ•°**: ç›´æ¥ä¼ é€’
2. **åŸºæœ¬ç±»å‹**: æ¡†æ¶ä¼šè‡ªåŠ¨ä»å­—ç¬¦ä¸²è½¬æ¢ï¼ˆå¦‚ `"42"` â†’ `42`ï¼‰
3. **å¤æ‚ç±»å‹**: éœ€è¦å…ˆåºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨ååºåˆ—åŒ–

```csharp
// è°ƒç”¨ç¤ºä¾‹ï¼š
await CallToolAsync("tool.name", new Dictionary<string, string>
{
    ["intParam"] = "42",              // string -> int (æ¡†æ¶è‡ªåŠ¨è½¬æ¢)
    ["stringParam"] = "hello",         // string -> string (ç›´æ¥)
    ["boolParam"] = "true",            // string -> bool (æ¡†æ¶è‡ªåŠ¨è½¬æ¢)
    ["complexParam"] = JsonSerializer.Serialize(myObject)  // object -> JSON string -> object (æ¡†æ¶ååºåˆ—åŒ–)
});
```

**è½¬æ¢è§„åˆ™**ï¼š
- åŸºæœ¬ç±»å‹ï¼ˆintã€boolã€double ç­‰ï¼‰ï¼šæ¡†æ¶ä½¿ç”¨ `Convert.ChangeType` ä»å­—ç¬¦ä¸²è½¬æ¢
- å¤æ‚ç±»å‹ï¼ˆç±»ã€åˆ—è¡¨ã€å­—å…¸ç­‰ï¼‰ï¼šæ¡†æ¶ä½¿ç”¨ JSON ååºåˆ—åŒ–
- å¯ç©ºç±»å‹ï¼šæ”¯æŒ `null` å­—ç¬¦ä¸²æˆ–ç©ºå­—ç¬¦ä¸²

### å·¥å…·å‘½åè§„èŒƒ

å»ºè®®ä½¿ç”¨ **åˆ†ç±».æ“ä½œ** çš„å‘½åæ ¼å¼ï¼š

```csharp
[MicroTool("http.get")]      // HTTP GET è¯·æ±‚
[MicroTool("http.post")]     // HTTP POST è¯·æ±‚
[MicroTool("file.read")]     // æ–‡ä»¶è¯»å–
[MicroTool("file.write")]    // æ–‡ä»¶å†™å…¥
[MicroTool("string.format")] // å­—ç¬¦ä¸²æ ¼å¼åŒ–
[MicroTool("math.calculate")] // æ•°å­¦è®¡ç®—
```

### é”™è¯¯å¤„ç†

å·¥å…·è°ƒç”¨å¯èƒ½æŠ›å‡ºä»¥ä¸‹å¼‚å¸¸ï¼š

```csharp
try
{
    var result = await CallToolAsync("tool.name", parameters);
}
catch (ToolNotFoundException ex)
{
    // å·¥å…·æœªæ‰¾åˆ°
    Context!.LogError($"å·¥å…· {ex.ToolName} æœªæ‰¾åˆ°", ex);
}
catch (ToolParameterException ex)
{
    // å‚æ•°é”™è¯¯ï¼ˆç¼ºå¤±ã€ç±»å‹ä¸åŒ¹é…ç­‰ï¼‰
    Context!.LogError($"å‚æ•° {ex.ParameterName} é”™è¯¯", ex);
}
catch (ToolExecutionException ex)
{
    // å·¥å…·æ‰§è¡Œå¤±è´¥
    Context!.LogError($"å·¥å…·æ‰§è¡Œå¤±è´¥", ex);
}
```

### UI å±•ç¤º

åœ¨è®¾ç½®ç•Œé¢çš„"æ’ä»¶ç®¡ç†"éƒ¨åˆ†ï¼Œä¼šè‡ªåŠ¨æ˜¾ç¤ºæ¯ä¸ªæ’ä»¶æ³¨å†Œçš„å·¥å…·ï¼š

- **å·¥å…·åˆ—è¡¨**: æ˜¾ç¤ºæ‰€æœ‰æ³¨å†Œçš„å·¥å…·åç§°
- **æ‚¬æµ®æç¤º**: é¼ æ ‡æ‚¬åœæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼š
  - å·¥å…·æè¿°
  - è¿”å›å€¼è¯´æ˜
  - å‚æ•°åˆ—è¡¨å’Œæè¿°
  - å‚æ•°ç±»å‹å’Œæ˜¯å¦å¯é€‰

### æœ€ä½³å®è·µ

1. **å·¥å…·è®¾è®¡**: 
   - ä¿æŒå·¥å…·åŠŸèƒ½å•ä¸€å’Œæ˜ç¡®
   - ä½¿ç”¨æ¸…æ™°çš„å‘½åå’Œè¯¦ç»†çš„æè¿°
   - è¿”å›å€¼ç»Ÿä¸€ä¸º JSON å­—ç¬¦ä¸²

2. **å‚æ•°è®¾è®¡**:
   - ä¼˜å…ˆä½¿ç”¨åŸºæœ¬ç±»å‹ï¼Œå‡å°‘åºåˆ—åŒ–å¼€é”€
   - ä¸ºå¯é€‰å‚æ•°æä¾›åˆç†çš„é»˜è®¤å€¼
   - ä½¿ç”¨ `Required = false` æ˜ç¡®æ ‡è®°å¯é€‰å‚æ•°

3. **å¼‚æ­¥ç¼–ç¨‹**:
   - æ‰€æœ‰å·¥å…·æ–¹æ³•å¿…é¡»æ˜¯ `async Task<string>`
   - é¿å…åœ¨å·¥å…·æ–¹æ³•ä¸­é˜»å¡çº¿ç¨‹
   - é€‚å½“ä½¿ç”¨ `ConfigureAwait(false)`

4. **é”™è¯¯å¤„ç†**:
   - æ•è·å¹¶è®°å½•å·¥å…·å†…éƒ¨çš„å¼‚å¸¸
   - è¿”å›æœ‰æ„ä¹‰çš„é”™è¯¯ä¿¡æ¯ï¼ˆJSON æ ¼å¼ï¼‰
   - ä¸è¦è®©å¼‚å¸¸ä¼ æ’­åˆ°æ¡†æ¶å±‚

### å·¥å…·ç¤ºä¾‹é›†åˆ

æŸ¥çœ‹ `Test` æ’ä»¶ä¸­çš„å®Œæ•´ç¤ºä¾‹ï¼š
- `test.reverse`: å­—ç¬¦ä¸²åè½¬
- `test.add`: æ•´æ•°ç›¸åŠ 
- `test.greet`: æ ¼å¼åŒ–é—®å€™è¯­ï¼ˆå¯é€‰å‚æ•°ï¼‰
- `test.processData`: å¤„ç†å¤æ‚å¯¹è±¡åˆ—è¡¨

---

## UI é¡µç­¾å¼€å‘è§„èŒƒ

### âš ï¸ é‡è¦ï¼šScrollViewer ä½¿ç”¨è§„èŒƒ

**ä» MicroDock v0.0.1.0 å¼€å§‹ï¼Œä¸»åº”ç”¨å·²åœ¨ NavigationView å±‚é¢ç»Ÿä¸€å¤„ç†æ»šåŠ¨åŠŸèƒ½ã€‚**

#### âœ… æ­£ç¡®åšæ³•

**ä¸è¦åœ¨æ’ä»¶é¡µç­¾çš„æœ€å¤–å±‚æ·»åŠ  ScrollViewer**ã€‚ä¸»åº”ç”¨ä¼šè‡ªåŠ¨æä¾›æ»šåŠ¨æ”¯æŒã€‚

```xml
<!-- âœ… æ­£ç¡®ï¼šç›´æ¥ä½¿ç”¨å¸ƒå±€å®¹å™¨ä½œä¸ºæ ¹å…ƒç´  -->
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="MyPlugin.MyTabView">
    <StackPanel Margin="10" Spacing="8">
        <TextBlock Text="æ ‡é¢˜"/>
        <TextBox Watermark="è¾“å…¥å†…å®¹"/>
        <Button Content="æäº¤"/>
        <!-- æ›´å¤šå†…å®¹... -->
    </StackPanel>
</UserControl>
```

#### âŒ é”™è¯¯åšæ³•

```xml
<!-- âŒ é”™è¯¯ï¼šä¸è¦åœ¨æœ€å¤–å±‚æ·»åŠ  ScrollViewer -->
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="MyPlugin.MyTabView">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="10" Spacing="8">
            <!-- å†…å®¹... -->
        </StackPanel>
    </ScrollViewer>
</UserControl>
```

#### ğŸ“‹ å±€éƒ¨æ»šåŠ¨åŒºåŸŸ

å¦‚æœæ‚¨çš„æ’ä»¶éœ€è¦åœ¨**ç‰¹å®šåŒºåŸŸ**å†…å®ç°ç‹¬ç«‹æ»šåŠ¨ï¼ˆä¾‹å¦‚åˆ—è¡¨ã€æ–‡æœ¬æ¡†ç­‰ï¼‰ï¼Œå¯ä»¥åœ¨è¯¥åŒºåŸŸä½¿ç”¨ ScrollViewerï¼š

```xml
<UserControl>
    <Grid RowDefinitions="Auto,*,Auto">
        <!-- å›ºå®šçš„å¤´éƒ¨åŒºåŸŸ -->
        <StackPanel Grid.Row="0">
            <TextBlock Text="å›ºå®šå¤´éƒ¨"/>
        </StackPanel>
        
        <!-- å¯æ»šåŠ¨çš„å†…å®¹åŒºåŸŸ -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto">
            <ListBox ItemsSource="{Binding Items}"/>
        </ScrollViewer>
        
        <!-- å›ºå®šçš„åº•éƒ¨åŒºåŸŸ -->
        <StackPanel Grid.Row="2">
            <Button Content="æäº¤"/>
        </StackPanel>
    </Grid>
</UserControl>
```

### UI å¸ƒå±€å»ºè®®

#### æ¨èçš„æ ¹å®¹å™¨

æ ¹æ®æ‚¨çš„å¸ƒå±€éœ€æ±‚é€‰æ‹©åˆé€‚çš„å®¹å™¨ï¼š

1. **StackPanel**: ç®€å•çš„å‚ç›´/æ°´å¹³å †å å¸ƒå±€
2. **Grid**: å¤æ‚çš„ç½‘æ ¼å¸ƒå±€
3. **DockPanel**: åœé å¼å¸ƒå±€
4. **Panel**: è‡ªå®šä¹‰å¸ƒå±€

#### è¾¹è·å’Œé—´è·

ä¸ºäº†ä¿æŒä¸ä¸»åº”ç”¨çš„ä¸€è‡´æ€§ï¼Œå»ºè®®ï¼š

```xml
<StackPanel Margin="0,12,12,12" Spacing="8">
    <!-- å†…å®¹ -->
</StackPanel>
```

- **Margin**: `0,12,12,12` (å·¦ã€ä¸Šã€å³ã€ä¸‹)
- **Spacing**: `8` åƒç´ ï¼ˆå…ƒç´ é—´è·ï¼‰

#### âš ï¸ çª—å£æœ€å°å°ºå¯¸è¦æ±‚

**MicroDock ä¸»çª—å£çš„æœ€å°å°ºå¯¸ä¸º 360Ã—360 åƒç´ **ï¼Œæ’ä»¶å¼€å‘è€…åº”ç¡®ä¿ UI å¸ƒå±€èƒ½å¤Ÿé€‚é…æ­¤æœ€å°å°ºå¯¸ã€‚

##### å¸ƒå±€é€‚é…å»ºè®®

1. **ä½¿ç”¨å“åº”å¼å¸ƒå±€**
   - ä¼˜å…ˆä½¿ç”¨ `Grid` å’Œ `*` å°ºå¯¸å•ä½ï¼Œè®©å†…å®¹è‡ªé€‚åº”å¯ç”¨ç©ºé—´
   - é¿å…å›ºå®šå®½åº¦çš„å…ƒç´ ï¼Œä½¿ç”¨ `MinWidth` å’Œ `MaxWidth` é™åˆ¶èŒƒå›´

2. **å†…å®¹å¯æ»šåŠ¨**
   - è™½ç„¶ä¸»åº”ç”¨æä¾›äº†ç»Ÿä¸€çš„æ»šåŠ¨æ”¯æŒï¼Œä½†æ’ä»¶å†…å®¹åº”è®¾è®¡ä¸ºåœ¨å°å°ºå¯¸ä¸‹ä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤º
   - é‡è¦å†…å®¹åº”ä¼˜å…ˆæ˜¾ç¤ºåœ¨å¯è§åŒºåŸŸå†…

3. **æ§ä»¶å°ºå¯¸æ§åˆ¶**
   ```xml
   <!-- âœ… æ¨èï¼šä½¿ç”¨æœ€å°/æœ€å¤§å°ºå¯¸é™åˆ¶ -->
   <TextBox MinWidth="200" MaxWidth="400"/>
   
   <!-- âŒ é¿å…ï¼šå›ºå®šå®½åº¦ -->
   <TextBox Width="400"/>
   ```

4. **å¸ƒå±€ç¤ºä¾‹**
   ```xml
   <UserControl>
       <Grid RowDefinitions="Auto,*,Auto">
           <!-- å›ºå®šé«˜åº¦çš„å¤´éƒ¨ -->
           <StackPanel Grid.Row="0" Margin="0,12,12,12">
               <TextBlock Text="æ ‡é¢˜" FontSize="16" FontWeight="Bold"/>
           </StackPanel>
           
           <!-- è‡ªé€‚åº”é«˜åº¦çš„å†…å®¹åŒºåŸŸ -->
           <StackPanel Grid.Row="1" Margin="0,0,12,12" Spacing="8">
               <!-- å†…å®¹ä¼šè‡ªåŠ¨é€‚åº”å¯ç”¨ç©ºé—´ -->
               <TextBox Watermark="è¾“å…¥å†…å®¹..." MinHeight="100"/>
               <ListBox ItemsSource="{Binding Items}" MinHeight="150"/>
           </StackPanel>
           
           <!-- å›ºå®šé«˜åº¦çš„åº•éƒ¨æ“ä½œåŒº -->
           <StackPanel Grid.Row="2" Orientation="Horizontal" 
                      HorizontalAlignment="Right" Margin="0,0,12,12">
               <Button Content="å–æ¶ˆ" Margin="0,0,8,0"/>
               <Button Content="ç¡®å®š"/>
           </StackPanel>
       </Grid>
   </UserControl>
   ```

5. **æµ‹è¯•å»ºè®®**
   - åœ¨å¼€å‘æ—¶ï¼Œå°†çª—å£è°ƒæ•´ä¸ºæœ€å°å°ºå¯¸ï¼ˆ360Ã—360ï¼‰æµ‹è¯•å¸ƒå±€æ•ˆæœ
   - ç¡®ä¿æ‰€æœ‰é‡è¦åŠŸèƒ½å’Œå†…å®¹åœ¨å°å°ºå¯¸ä¸‹éƒ½èƒ½æ­£å¸¸è®¿é—®
   - æ£€æŸ¥æ–‡æœ¬æ˜¯å¦è¢«æˆªæ–­ï¼Œæ§ä»¶æ˜¯å¦é‡å 

### Avalonia æ§ä»¶ä½¿ç”¨

#### FluentAvaloniaUI ç»„ä»¶

æ¨èä½¿ç”¨ FluentAvaloniaUI ç»„ä»¶ä»¥ä¿æŒ UI é£æ ¼ä¸€è‡´ï¼š

```xml
<UserControl xmlns:fa="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia">
    <StackPanel>
        <!-- å¯æŠ˜å çš„è®¾ç½®é¢æ¿ -->
        <fa:SettingsExpander Header="è®¾ç½®é¡¹" IconSource="Setting">
            <StackPanel>
                <!-- è®¾ç½®å†…å®¹ -->
            </StackPanel>
        </fa:SettingsExpander>
    </StackPanel>
</UserControl>
```

#### å¸¸ç”¨æ§ä»¶ç¤ºä¾‹

```xml
<!-- æ–‡æœ¬è¾“å…¥ -->
<TextBox Watermark="è¯·è¾“å…¥..." 
         AcceptsReturn="True"
         MinHeight="100"/>

<!-- æŒ‰é’® -->
<Button Content="æ“ä½œ" 
        Padding="20,8"
        Command="{Binding MyCommand}"/>

<!-- å¼€å…³ -->
<ToggleSwitch IsChecked="{Binding IsEnabled}"
              OnContent="å¼€å¯"
              OffContent="å…³é—­"/>

<!-- ä¸‹æ‹‰æ¡† -->
<ComboBox ItemsSource="{Binding Options}"
          SelectedItem="{Binding SelectedOption}"/>
```

---

## æ’ä»¶ä¸Šä¸‹æ–‡ API

### ğŸ“ æ—¥å¿—ç³»ç»Ÿ

MicroDock æä¾›äº†å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿï¼Œæ’ä»¶å¯ä»¥é€šè¿‡ `Context` å±æ€§è®¿é—®æ—¥å¿—æ–¹æ³•ã€‚æ‰€æœ‰æ—¥å¿—éƒ½ä¼šè‡ªåŠ¨æ·»åŠ æ’ä»¶åç§°å‰ç¼€ï¼Œæ–¹ä¾¿åœ¨æ—¥å¿—æŸ¥çœ‹å™¨ä¸­è¯†åˆ«å’Œè¿‡æ»¤ã€‚

#### æ—¥å¿—çº§åˆ«

æ’ä»¶æ”¯æŒå››ç§æ—¥å¿—çº§åˆ«ï¼š

1. **Debugï¼ˆè°ƒè¯•ï¼‰**: è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼Œé€šå¸¸åªåœ¨å¼€å‘æ—¶ä½¿ç”¨
2. **Infoï¼ˆä¿¡æ¯ï¼‰**: ä¸€èˆ¬æ€§çš„ä¿¡æ¯è®°å½•ï¼Œç”¨äºè®°å½•æ­£å¸¸æ“ä½œæµç¨‹
3. **Warningï¼ˆè­¦å‘Šï¼‰**: è­¦å‘Šä¿¡æ¯ï¼Œè¡¨ç¤ºå¯èƒ½å­˜åœ¨é—®é¢˜ä½†ä¸å½±å“åŠŸèƒ½
4. **Errorï¼ˆé”™è¯¯ï¼‰**: é”™è¯¯ä¿¡æ¯ï¼Œè¡¨ç¤ºå‘ç”Ÿäº†é”™è¯¯ï¼Œå¯ä»¥åŒ…å«å¼‚å¸¸å¯¹è±¡

#### æ—¥å¿—æ–¹æ³•

æ—¥å¿—æ–¹æ³•é€šè¿‡ `Context` å±æ€§è®¿é—®ï¼š

```csharp
public class MyPlugin : BaseMicroDockPlugin
{
    public override void OnInit()
    {
        base.OnInit();
        
        // è°ƒè¯•æ—¥å¿— - ç”¨äºå¼€å‘è°ƒè¯•
        Context!.LogDebug("æ’ä»¶åˆå§‹åŒ–å¼€å§‹");
        
        // ä¿¡æ¯æ—¥å¿— - è®°å½•æ­£å¸¸æ“ä½œ
        Context!.LogInfo("æ’ä»¶å·²æˆåŠŸåˆå§‹åŒ–");
        
        // è­¦å‘Šæ—¥å¿— - è®°å½•æ½œåœ¨é—®é¢˜
        if (someCondition)
        {
            Context!.LogWarning("æ£€æµ‹åˆ°æ½œåœ¨é—®é¢˜ï¼Œä½†ç»§ç»­æ‰§è¡Œ");
        }
        
        // é”™è¯¯æ—¥å¿— - è®°å½•é”™è¯¯å’Œå¼‚å¸¸
        try
        {
            // å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ“ä½œ
            DoSomething();
        }
        catch (Exception ex)
        {
            Context!.LogError("æ“ä½œå¤±è´¥", ex);  // åŒ…å«å¼‚å¸¸å¯¹è±¡
        }
    }
}
```

**æ³¨æ„**: `Context` æ˜¯ `public` å±æ€§ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ã€‚ä½¿ç”¨ `!` ç©ºå€¼æŠ‘åˆ¶æ“ä½œç¬¦æ˜¯å› ä¸ºæ¡†æ¶ä¿è¯åœ¨æ’ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­ `Context` å·²åˆå§‹åŒ–ã€‚

#### æ—¥å¿—ä½¿ç”¨ç¤ºä¾‹

**åŸºæœ¬ä½¿ç”¨**:
```csharp
// è®°å½•ä¿¡æ¯æ—¥å¿—
Context!.LogInfo("ç”¨æˆ·ç‚¹å‡»äº†æŒ‰é’®");

// è®°å½•è­¦å‘Šæ—¥å¿—
Context!.LogWarning("é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®");

// è®°å½•é”™è¯¯æ—¥å¿—ï¼ˆæ— å¼‚å¸¸ï¼‰
Context!.LogError("æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨");

// è®°å½•é”™è¯¯æ—¥å¿—ï¼ˆåŒ…å«å¼‚å¸¸ï¼‰
try
{
    ProcessData();
}
catch (Exception ex)
{
    Context!.LogError("æ•°æ®å¤„ç†å¤±è´¥", ex);
}
```

**åœ¨å·¥å…·æ–¹æ³•ä¸­ä½¿ç”¨**:
```csharp
[MicroTool("example.process",
    Description = "å¤„ç†æ•°æ®ç¤ºä¾‹",
    ReturnDescription = "å¤„ç†ç»“æœ")]
public async Task<string> ProcessData(
    [ToolParameter("data", Description = "è¦å¤„ç†çš„æ•°æ®")] string data)
{
    Context!.LogInfo($"å¼€å§‹å¤„ç†æ•°æ®: {data}");
    
    try
    {
        // å¤„ç†é€»è¾‘
        var result = await ProcessAsync(data);
        Context!.LogInfo($"æ•°æ®å¤„ç†å®Œæˆ: {result}");
        return result;
    }
    catch (Exception ex)
    {
        Context!.LogError($"æ•°æ®å¤„ç†å¤±è´¥: {data}", ex);
        throw;  // é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œè®©æ¡†æ¶å¤„ç†
    }
}
```

**åœ¨å¼‚æ­¥æ“ä½œä¸­ä½¿ç”¨**:
```csharp
public async Task LoadDataAsync()
{
    Context!.LogDebug("å¼€å§‹åŠ è½½æ•°æ®");
    
    try
    {
        var data = await FetchDataFromApi();
        Context!.LogInfo($"æˆåŠŸåŠ è½½ {data.Count} æ¡è®°å½•");
        return data;
    }
    catch (HttpRequestException ex)
    {
        Context!.LogError("ç½‘ç»œè¯·æ±‚å¤±è´¥", ex);
        throw;
    }
    catch (Exception ex)
    {
        Context!.LogError("æœªçŸ¥é”™è¯¯", ex);
        throw;
    }
}
```

#### æ—¥å¿—æŸ¥çœ‹

æ‰€æœ‰æ’ä»¶æ—¥å¿—éƒ½ä¼šï¼š
- **è‡ªåŠ¨æ·»åŠ æ’ä»¶åç§°å‰ç¼€**: æ ¼å¼ä¸º `[Plugin:æ’ä»¶åç§°]`
- **è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶**: å¯ä»¥åœ¨ä¸»åº”ç”¨çš„"æ—¥å¿—æŸ¥çœ‹å™¨"æ ‡ç­¾é¡µä¸­æŸ¥çœ‹
- **æ”¯æŒæ—¥å¿—çº§åˆ«ç­›é€‰**: åœ¨æ—¥å¿—æŸ¥çœ‹å™¨ä¸­å¯ä»¥æŒ‰çº§åˆ«è¿‡æ»¤
- **æ”¯æŒå…³é”®å­—æœç´¢**: å¯ä»¥æœç´¢ç‰¹å®šæ’ä»¶çš„æ—¥å¿—

#### æ—¥å¿—æœ€ä½³å®è·µ

1. **åˆç†ä½¿ç”¨æ—¥å¿—çº§åˆ«**:
   - `Debug`: ä»…åœ¨å¼€å‘è°ƒè¯•æ—¶ä½¿ç”¨ï¼Œç”Ÿäº§ç¯å¢ƒå¯èƒ½ä¸è¾“å‡º
   - `Info`: è®°å½•é‡è¦çš„æ“ä½œå’ŒçŠ¶æ€å˜åŒ–
   - `Warning`: è®°å½•å¯èƒ½çš„é—®é¢˜ï¼Œä½†ä¸å½±å“åŠŸèƒ½
   - `Error`: è®°å½•é”™è¯¯å’Œå¼‚å¸¸ï¼Œå¿…é¡»åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯

2. **æä¾›æœ‰æ„ä¹‰çš„æ—¥å¿—æ¶ˆæ¯**:
   ```csharp
   // âŒ ä¸å¥½çš„æ—¥å¿—
   Context!.LogInfo("å¤„ç†å®Œæˆ");
   
   // âœ… å¥½çš„æ—¥å¿—
   Context!.LogInfo($"æ•°æ®å¤„ç†å®Œæˆï¼Œå…±å¤„ç† {count} æ¡è®°å½•ï¼Œè€—æ—¶ {duration}ms");
   ```

3. **åœ¨å…³é”®æ“ä½œç‚¹è®°å½•æ—¥å¿—**:
   ```csharp
   public override void OnInit()
   {
       Context!.LogInfo("æ’ä»¶åˆå§‹åŒ–å¼€å§‹");
       // ... åˆå§‹åŒ–é€»è¾‘ ...
       Context!.LogInfo("æ’ä»¶åˆå§‹åŒ–å®Œæˆ");
   }
   
   public override void OnDestroy()
   {
       Context!.LogInfo("æ’ä»¶å¼€å§‹é”€æ¯");
       // ... æ¸…ç†é€»è¾‘ ...
       Context!.LogInfo("æ’ä»¶é”€æ¯å®Œæˆ");
   }
   ```

4. **é”™è¯¯æ—¥å¿—åº”åŒ…å«å¼‚å¸¸å¯¹è±¡**:
   ```csharp
   // âœ… æ­£ç¡®ï¼šåŒ…å«å¼‚å¸¸å¯¹è±¡
   catch (Exception ex)
   {
       Context!.LogError("æ“ä½œå¤±è´¥", ex);
   }
   
   // âš ï¸ ä¸æ¨èï¼šåªè®°å½•æ¶ˆæ¯
   catch (Exception ex)
   {
       Context!.LogError($"æ“ä½œå¤±è´¥: {ex.Message}");
   }
   ```

5. **é¿å…åœ¨å¾ªç¯ä¸­è®°å½•è¿‡å¤šæ—¥å¿—**:
   ```csharp
   // âŒ ä¸æ¨èï¼šåœ¨å¾ªç¯ä¸­è®°å½•æ¯æ¡è®°å½•
   foreach (var item in items)
   {
       Context!.LogInfo($"å¤„ç†é¡¹: {item}");  // å¯èƒ½äº§ç”Ÿå¤§é‡æ—¥å¿—
   }
   
   // âœ… æ¨èï¼šè®°å½•æ±‡æ€»ä¿¡æ¯
   Context!.LogInfo($"å¼€å§‹å¤„ç† {items.Count} é¡¹");
   foreach (var item in items)
   {
       ProcessItem(item);
   }
   Context!.LogInfo($"å¤„ç†å®Œæˆï¼Œå…±å¤„ç† {items.Count} é¡¹");
   ```

### ğŸ–¼ï¸ å›¾ç‰‡ç®¡ç†

æ’ä»¶å¯ä»¥ä¿å­˜å’ŒåŠ è½½å›¾ç‰‡æ•°æ®ï¼š

```csharp
// ä¿å­˜å›¾ç‰‡
byte[] imageData = File.ReadAllBytes("icon.png");
SaveImage("my_icon", imageData);

// åŠ è½½å›¾ç‰‡
byte[]? loadedImage = LoadImage("my_icon");

// åˆ é™¤å›¾ç‰‡
DeleteImage("my_icon");
```

**ä½¿ç”¨åœºæ™¯**:
- ç¼“å­˜ç½‘ç»œå›¾ç‰‡
- ä¿å­˜ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡
- å­˜å‚¨æ’ä»¶å›¾æ ‡

### ğŸ“ è·¯å¾„ç®¡ç†

æ’ä»¶å¯ä»¥è·å–ä¸“ç”¨çš„ç›®å½•è·¯å¾„ï¼š

```csharp
// è·å–æ’ä»¶é…ç½®ç›®å½•
string configPath = GetConfigPath();
// ä¾‹å¦‚: C:\Users\...\Plugins\MyPlugin\config

// è·å–æ’ä»¶æ•°æ®ç›®å½•
string dataPath = GetPluginDataPath();
// ä¾‹å¦‚: C:\Users\...\Plugins\MyPlugin\data

// è·å–æ’ä»¶æ•°æ®ç›®å½•
string tempDataPath = GetPluginTempDataPath();
// ä¾‹å¦‚: C:\Users\...\Plugins\MyPlugin\temp_data
```

#### âš ï¸ é‡è¦ï¼šConfig , Data å’Œ TempData ç›®å½•çš„åŒºåˆ«

åœ¨æ’ä»¶å¼€å‘ä¸­ï¼ŒConfig , Data å’Œ TempData ç›®å½•æœ‰ä¸åŒçš„ç”¨é€”å’Œç”Ÿå‘½å‘¨æœŸï¼š

##### Config ç›®å½• - æ’ä»¶é…ç½®ï¼ˆéšç‰ˆæœ¬æ›´æ–°ï¼‰

- **ç”¨é€”**: å­˜å‚¨æ’ä»¶è‡ªèº«çš„é…ç½®æ–‡ä»¶ã€é»˜è®¤è®¾ç½®ã€é¢„è®¾æ¨¡æ¿ç­‰
- **ç‰¹ç‚¹**: 
  - éšæ’ä»¶ç‰ˆæœ¬æ›´æ–°è€Œæ›´æ–°
  - **æ’ä»¶æ›´æ–°æ—¶ä¼šè¢«åˆ é™¤å¹¶æ›¿æ¢ä¸ºæ–°ç‰ˆæœ¬çš„ Config**
  - ä¸åº”å­˜å‚¨ç”¨æˆ·ä¸ªæ€§åŒ–æ•°æ®
- **ç¤ºä¾‹**:
  - æ’ä»¶çš„é»˜è®¤é…ç½®æ¨¡æ¿
  - é¢„è®¾çš„å·¥ä½œæµé…ç½®
  - æ’ä»¶å†…ç½®çš„èµ„æºæ–‡ä»¶å¼•ç”¨

```csharp
// âŒ é”™è¯¯ï¼šä¸è¦åœ¨ Config ä¸­å­˜å‚¨ç”¨æˆ·æ•°æ®
string userPreference = File.ReadAllText(Path.Combine(Context.ConfigPath, "user_settings.json"));

// âœ… æ­£ç¡®ï¼šConfig ç”¨äºæ’ä»¶é»˜è®¤é…ç½®
string defaultTemplate = File.ReadAllText(Path.Combine(Context.ConfigPath, "default_template.json"));
```

##### Data ç›®å½• - ç”¨æˆ·æ•°æ®ï¼ˆæ°¸ä¹…ä¿ç•™,ä¸”ä¼šå¤‡ä»½è‡³æœåŠ¡å™¨ï¼‰

- **ç”¨é€”**: å­˜å‚¨ç”¨æˆ·åˆ›å»ºã€ç¼–è¾‘çš„æ•°æ®å’Œä¸ªæ€§åŒ–è®¾ç½®
- **ç‰¹ç‚¹**:
  - **æ’ä»¶æ›´æ–°æ—¶ä¼šè¢«ä¿ç•™**
  - å­˜å‚¨ç”¨æˆ·çš„ä¸ªæ€§åŒ–æ•°æ®
  - è·¨ç‰ˆæœ¬æŒä¹…åŒ–
- **ç¤ºä¾‹**:
  - ç”¨æˆ·åˆ›å»ºçš„é¡¹ç›®æ–‡ä»¶
  - ç”¨æˆ·çš„ä¸ªæ€§åŒ–è®¾ç½®
  - ç”¨æˆ·ä¸Šä¼ çš„èµ„æºæ–‡ä»¶
  - åº”ç”¨çŠ¶æ€å’Œå†å²è®°å½•

```csharp
// âœ… æ­£ç¡®ï¼šç”¨æˆ·æ•°æ®å­˜å‚¨åœ¨ Data ç›®å½•
string userProjects = Path.Combine(Context.DataPath, "projects");
Directory.CreateDirectory(userProjects);
File.WriteAllText(Path.Combine(userProjects, "my_project.json"), projectData);
```

##### TempData ç›®å½• - ä¸´æ—¶æ•°æ®ï¼ˆä¸ä¼šå¤‡ä»½è‡³æœåŠ¡å™¨ï¼‰

- **ç”¨é€”**: å­˜å‚¨ä¸´æ—¶ç¼“å­˜ã€è¿è¡Œæ—¶ç”Ÿæˆçš„æ–‡ä»¶å’Œä¸éœ€è¦å¤‡ä»½çš„æ•°æ®
- **ç‰¹ç‚¹**:
  - **æ’ä»¶æ›´æ–°æ—¶ä¼šè¢«ä¿ç•™**
  - **ä¸ä¼šå¤‡ä»½è‡³æœåŠ¡å™¨**ï¼Œä¸¢å¤±åä¸å½±å“æ ¸å¿ƒåŠŸèƒ½
  - é€‚åˆå­˜å‚¨å¯é‡æ–°ç”Ÿæˆæˆ–ä¸‹è½½çš„æ•°æ®
  - å¯ç”¨äºå¤§æ–‡ä»¶ç¼“å­˜ï¼Œé¿å…å ç”¨å¤‡ä»½ç©ºé—´
- **ç¤ºä¾‹**:
  - ç½‘ç»œè¯·æ±‚çš„ç¼“å­˜æ•°æ®
  - å›¾ç‰‡/è§†é¢‘çš„ä¸´æ—¶ç¼©ç•¥å›¾
  - æ—¥å¿—æ–‡ä»¶å’Œè°ƒè¯•ä¿¡æ¯
  - ä¸‹è½½çš„ä¸´æ—¶æ–‡ä»¶
  - è¿è¡Œæ—¶ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶

```csharp
// âœ… æ­£ç¡®ï¼šä¸´æ—¶ç¼“å­˜å­˜å‚¨åœ¨ TempData ç›®å½•
string cacheDir = Path.Combine(Context.TempDataPath, "cache");
Directory.CreateDirectory(cacheDir);

// ç¼“å­˜ç½‘ç»œè¯·æ±‚ç»“æœ
File.WriteAllText(Path.Combine(cacheDir, "api_response.json"), responseJson);

// å­˜å‚¨ä¸´æ—¶ç¼©ç•¥å›¾
File.WriteAllBytes(Path.Combine(cacheDir, "thumbnail.png"), thumbnailBytes);// ... existing code ...
```

##### æœ€ä½³å®è·µ

1. **æ˜ç¡®æ•°æ®å½’å±**ï¼š
   - æ’ä»¶è‡ªå¸¦çš„ â†’ Config
   - ç”¨æˆ·åˆ›å»ºçš„ â†’ Data
   - ä¸´æ—¶ç¼“å­˜/å¯é‡æ–°ç”Ÿæˆçš„æ•°æ® â†’ TempData

2. **é€‰æ‹©æ­£ç¡®çš„å­˜å‚¨ç›®å½•**ï¼š
   
   // âŒ é”™è¯¯ï¼šå°†ç¼“å­˜æ•°æ®æ”¾åœ¨ Data ç›®å½•ä¼šå¯¼è‡´å¤‡ä»½ä½“ç§¯è¿‡å¤§
   string cacheDir = Path.Combine(Context.DataPath, "cache");
   
   // âœ… æ­£ç¡®ï¼šç¼“å­˜æ•°æ®åº”æ”¾åœ¨ TempData ç›®å½•
   string cacheDir = Path.Combine(Context.TempDataPath, "cache");

3. **TempData ä½¿ç”¨åŸåˆ™**ï¼š
   - å­˜å‚¨çš„æ•°æ®åº”è¯¥æ˜¯"å¯ä¸¢å¤±"çš„
   - æ•°æ®ä¸¢å¤±ååº”è¯¥èƒ½å¤Ÿé€šè¿‡é‡æ–°ä¸‹è½½/ç”Ÿæˆæ¢å¤
   - ä¸è¦å­˜å‚¨ç”¨æˆ·æ‰‹åŠ¨åˆ›å»ºæˆ–ç¼–è¾‘çš„å†…å®¹
   - å®šæœŸæ¸…ç†è¿‡æœŸçš„ç¼“å­˜æ–‡ä»¶

4. **ä½¿ç”¨æ–‡ä»¶å­˜å‚¨æ•°æ®**ï¼š
   - ç®€å•çš„é…ç½® â†’ ä½¿ç”¨ JSON æ–‡ä»¶å­˜å‚¨åœ¨ Data ç›®å½•
   - ç»“æ„åŒ–æ•°æ® â†’ ä½¿ç”¨ JSON/SQLite å­˜å‚¨åœ¨ Data ç›®å½•
   - å¤§æ–‡ä»¶/äºŒè¿›åˆ¶ â†’ ä½¿ç”¨ Data ç›®å½•
   - ä¸´æ—¶æ•°æ® â†’ ä½¿ç”¨ TempData ç›®å½•

**ç¤ºä¾‹ï¼šä½¿ç”¨ JSON æ–‡ä»¶å­˜å‚¨é…ç½®**:

```csharp
// é…ç½®ç±»
public class MyPluginConfig
{
    public string ApiKey { get; set; } = "";
    public string BaseUrl { get; set; } = "https://api.example.com";
    public int MaxRetries { get; set; } = 3;
}

// åŠ è½½é…ç½®
private MyPluginConfig LoadConfig()
{
    string configFile = Path.Combine(Context!.DataPath, "config.json");
    if (File.Exists(configFile))
    {
        string json = File.ReadAllText(configFile);
        return JsonSerializer.Deserialize<MyPluginConfig>(json) ?? new MyPluginConfig();
    }
    return new MyPluginConfig();
}

// ä¿å­˜é…ç½®
private void SaveConfig(MyPluginConfig config)
{
    string configFile = Path.Combine(Context!.DataPath, "config.json");
    string json = JsonSerializer.Serialize(config, new JsonSerializerOptions { WriteIndented = true });
    File.WriteAllText(configFile, json);
}
```

5. **æ–‡æ¡£è¯´æ˜**ï¼š

åœ¨æ’ä»¶çš„ README ä¸­è¯´æ˜ï¼š
- Config ç›®å½•çš„å†…å®¹å’Œç”¨é€”
- Data ç›®å½•ä¼šå­˜å‚¨å“ªäº›ç”¨æˆ·æ•°æ®
- TempData ç›®å½•çš„å†…å®¹å’Œç”¨é€”
- æ•°æ®è¿ç§»å’Œå¤‡ä»½å»ºè®®

**ç›®å½•ç»“æ„**:
```
Plugins/
â””â”€â”€ MyPlugin/
    â”œâ”€â”€ config/      # é…ç½®ç›®å½•ï¼ˆGetConfigPath()ï¼‰- éšæ’ä»¶ç‰ˆæœ¬æ›´æ–°
    â”œâ”€â”€ data/        # æ•°æ®ç›®å½•ï¼ˆGetPluginDataPath()ï¼‰- ä¼šå¤‡ä»½è‡³æœåŠ¡å™¨
    â”œâ”€â”€ temp_data/   # ä¸´æ—¶æ•°æ®ç›®å½•ï¼ˆGetPluginTempDataPath()ï¼‰- ä¸ä¼šå¤‡ä»½
    â”œâ”€â”€ dll/         # æ’ä»¶ä¾èµ–çš„åº“
    â”œâ”€â”€ plugin.json   # æ’ä»¶ä¿¡æ¯æ–‡ä»¶
    â””â”€â”€ MyPlugin.dll
```

### ğŸ”” é€šçŸ¥ç³»ç»Ÿ

æ’ä»¶å¯ä»¥æ˜¾ç¤ºåº”ç”¨å†…é€šçŸ¥å’Œç³»ç»Ÿæ‰˜ç›˜é€šçŸ¥ï¼š

```csharp
// åº”ç”¨å†…é€šçŸ¥ï¼ˆçª—å£å†… Toastï¼‰
Context!.ShowInAppNotification("æ“ä½œå®Œæˆ", "æ•°æ®å·²æˆåŠŸä¿å­˜", NotificationType.Success);

// ç³»ç»Ÿæ‰˜ç›˜é€šçŸ¥
Context!.ShowSystemNotification("æ–°æ¶ˆæ¯", "æ‚¨æœ‰ä¸€æ¡æ–°æ¶ˆæ¯", new Dictionary<string, string>
{
    ["æŸ¥çœ‹"] = "view_message",
    ["å¿½ç•¥"] = "ignore_message"
});
```

**æ³¨æ„**: é€šçŸ¥ API éœ€è¦é€šè¿‡ `Context` å±æ€§è®¿é—®ï¼ˆ`Context` æ˜¯ `public` çš„ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼‰ã€‚

**é€šçŸ¥ç±»å‹**:
- `NotificationType.Information` - ä¿¡æ¯é€šçŸ¥
- `NotificationType.Success` - æˆåŠŸé€šçŸ¥
- `NotificationType.Warning` - è­¦å‘Šé€šçŸ¥
- `NotificationType.Error` - é”™è¯¯é€šçŸ¥

### â³ Loading æŒ‡ç¤ºå™¨

æ’ä»¶å¯ä»¥æ˜¾ç¤ºå…¨å± Loading æŒ‡ç¤ºå™¨ï¼š

```csharp
// æ˜¾ç¤º Loadingï¼ˆå¸¦æ¶ˆæ¯ï¼‰
Context!.ShowLoading("æ­£åœ¨åŠ è½½æ•°æ®...");

try
{
    await LoadDataAsync();
}
finally
{
    // ç¡®ä¿éšè— Loading
    Context!.HideLoading();
}
```

**æ³¨æ„**: Loading API éœ€è¦é€šè¿‡ `Context` å±æ€§è®¿é—®ã€‚

**ä½¿ç”¨å»ºè®®**:
- ç”¨äºé•¿æ—¶é—´è¿è¡Œçš„æ“ä½œï¼ˆ> 1ç§’ï¼‰
- å¿…é¡»åœ¨ `finally` å—ä¸­è°ƒç”¨ `HideLoading()`ï¼Œç¡®ä¿æ€»æ˜¯éšè—
- é¿å…åµŒå¥—ä½¿ç”¨

### ğŸ¯ æ‰˜ç›˜èœå•

æ’ä»¶å¯ä»¥æ·»åŠ ç³»ç»Ÿæ‰˜ç›˜èœå•é¡¹ï¼š

```csharp
public override void OnInit()
{
    base.OnInit();
    
    // æ·»åŠ èœå•é¡¹
    Context!.AddTrayMenuItem("myplugin_action", "æ‰§è¡Œæ“ä½œ", () =>
    {
        Context!.LogInfo("ç”¨æˆ·ç‚¹å‡»äº†æ‰˜ç›˜èœå•é¡¹");
        DoSomething();
    });
    
    // æ·»åŠ åˆ†éš”ç¬¦
    Context!.AddTrayMenuSeparator("myplugin_separator");
}

public override void OnDestroy()
{
    // æ¸…ç†æ—¶ç§»é™¤èœå•é¡¹
    Context!.RemoveTrayMenuItem("myplugin_action");
    Context!.RemoveTrayMenuItem("myplugin_separator");
    base.OnDestroy();
}
```

**æ³¨æ„äº‹é¡¹**:
- èœå•é¡¹ ID å¿…é¡»å”¯ä¸€ï¼ˆå»ºè®®ä½¿ç”¨æ’ä»¶åå‰ç¼€ï¼‰
- åœ¨ `OnDestroy()` ä¸­æ¸…ç†æ·»åŠ çš„èœå•é¡¹
- åˆ†éš”ç¬¦ä¹Ÿéœ€è¦é€šè¿‡ `RemoveTrayMenuItem()` ç§»é™¤

### ğŸ”„ é€šè¿‡å·¥å…·å…±äº«é…ç½®

å¦‚æœæŸä¸ªæ’ä»¶éœ€è¦è®©å…¶ä»–æ’ä»¶è®¿é—®è‡ªå·±çš„é…ç½®ï¼Œå¯ä»¥é€šè¿‡å®šä¹‰å·¥å…·ï¼ˆToolï¼‰çš„æ–¹å¼æš´éœ²ï¼š

**æ’ä»¶ Aï¼šæš´éœ²é…ç½®å·¥å…·**

```csharp
/// <summary>
/// è·å–é…ç½®ä¿¡æ¯ï¼ˆä¾›å…¶ä»–æ’ä»¶è°ƒç”¨ï¼‰
/// </summary>
[MicroTool("myconfig.get",
    Description = "è·å–æ’ä»¶é…ç½®ä¿¡æ¯",
    ReturnDescription = "é…ç½®ä¿¡æ¯çš„ JSON å­—ç¬¦ä¸²")]
public async Task<string> GetConfigTool()
{
    await Task.CompletedTask;
    
    // åªæš´éœ²éæ•æ„Ÿä¿¡æ¯
    return JsonSerializer.Serialize(new
    {
        baseUrl = _config.BaseUrl,
        model = _config.Model,
        maxRetries = _config.MaxRetries,
        // æ³¨æ„ï¼šä¸æš´éœ²æ•æ„Ÿä¿¡æ¯å¦‚ API Key
        hasApiKey = !string.IsNullOrEmpty(_config.ApiKey)
    });
}
```

**æ’ä»¶ Bï¼šè°ƒç”¨å…¶ä»–æ’ä»¶çš„é…ç½®å·¥å…·**

```csharp
public override void OnAllPluginsLoaded()
{
    base.OnAllPluginsLoaded();
    
    // åœ¨æ‰€æœ‰æ’ä»¶åŠ è½½å®Œæˆåè°ƒç”¨å…¶ä»–æ’ä»¶çš„å·¥å…·
    Task.Run(async () =>
    {
        try
        {
            string configJson = await CallToolAsync("myconfig.get", 
                new Dictionary<string, string>(), 
                pluginName: "com.example.myplugin");
            
            var config = JsonSerializer.Deserialize<MyConfigResponse>(configJson);
            Context!.LogInfo($"è·å–åˆ°å…¶ä»–æ’ä»¶é…ç½®: BaseUrl={config?.baseUrl}");
        }
        catch (Exception ex)
        {
            Context!.LogError("è·å–é…ç½®å¤±è´¥", ex);
        }
    });
}
```

**ä¼˜ç‚¹**:
- **å®‰å…¨å¯æ§**: æ’ä»¶å¯ä»¥ç²¾ç»†æ§åˆ¶å“ªäº›é…ç½®å¯ä»¥å¯¹å¤–æš´éœ²
- **è§£è€¦è®¾è®¡**: æ’ä»¶ä¹‹é—´é€šè¿‡æ ‡å‡†åŒ–çš„å·¥å…·è°ƒç”¨é€šä¿¡
- **çµæ´»æ€§**: å¯ä»¥è¿”å›ä»»æ„æ ¼å¼çš„æ•°æ®ï¼Œæ”¯æŒå¤æ‚çš„æŸ¥è¯¢é€»è¾‘

---

## æœ€ä½³å®è·µ

### 1. èµ„æºç®¡ç†

å®ç° `IDisposable` ä»¥æ­£ç¡®é‡Šæ”¾èµ„æºï¼š

```csharp
public class MyPlugin : BaseMicroDockPlugin, IDisposable
{
    private Timer? _timer;
    private HttpClient? _httpClient;

    public override void Initialize(IPluginContext context)
    {
        _timer = new Timer(OnTimerTick, null, 0, 1000);
        _httpClient = new HttpClient();
    }

    public void Dispose()
    {
        _timer?.Dispose();
        _httpClient?.Dispose();
    }

    public override void Shutdown()
    {
        Dispose();
    }
}
```

### 2. é”™è¯¯å¤„ç†

å§‹ç»ˆæ•è·å’Œå¤„ç†å¼‚å¸¸ï¼Œé¿å…æ’ä»¶é”™è¯¯å½±å“ä¸»åº”ç”¨ï¼š

```csharp
public override void Initialize(IPluginContext context)
{
    try
    {
        // åˆå§‹åŒ–é€»è¾‘
        LoadConfiguration();
        InitializeServices();
    }
    catch (Exception ex)
    {
        Console.WriteLine($"æ’ä»¶åˆå§‹åŒ–å¤±è´¥: {ex.Message}");
        // å¯ä»¥é€‰æ‹©ä½¿ç”¨æ—¥å¿—æ¡†æ¶è®°å½•é”™è¯¯
    }
}
```

### 3. å¼‚æ­¥æ“ä½œ

ä½¿ç”¨ async/await å¤„ç†å¼‚æ­¥æ“ä½œï¼š

```csharp
public async Task LoadDataAsync()
{
    try
    {
        var data = await _httpClient.GetStringAsync("https://api.example.com/data");
        // å¤„ç†æ•°æ®
    }
    catch (Exception ex)
    {
        // é”™è¯¯å¤„ç†
    }
}
```

### 4. MVVM æ¨¡å¼

éµå¾ª MVVM æ¨¡å¼ç»„ç»‡ä»£ç ï¼š

```
MyPlugin/
â”œâ”€â”€ ViewModels/
â”‚   â””â”€â”€ MyTabViewModel.cs
â”œâ”€â”€ Views/
â”‚   â””â”€â”€ MyTabView.axaml
â”‚   â””â”€â”€ MyTabView.axaml.cs
â”œâ”€â”€ Models/
â”‚   â””â”€â”€ MyDataModel.cs
â””â”€â”€ MyPlugin.cs
```

### 5. æ€§èƒ½è€ƒè™‘

- **å»¶è¿ŸåŠ è½½**: ä»…åœ¨éœ€è¦æ—¶åŠ è½½èµ„æº
- **ç¼“å­˜æ•°æ®**: é¿å…é‡å¤çš„ç½‘ç»œè¯·æ±‚æˆ–è®¡ç®—
- **é¿å…é˜»å¡ UI**: å°†è€—æ—¶æ“ä½œæ”¾åœ¨åå°çº¿ç¨‹

```csharp
// ä½¿ç”¨ Task.Run æ‰§è¡Œè€—æ—¶æ“ä½œ
await Task.Run(() =>
{
    // è€—æ—¶çš„æ•°æ®å¤„ç†
    ProcessLargeDataSet();
});
```

---

## å¸¸è§é—®é¢˜

### Q: æ’ä»¶å¦‚ä½•è°ƒè¯•ï¼Ÿ

**A**: æœ‰ä¸¤ç§æ–¹æ³•ï¼š

1. **æ§åˆ¶å°è¾“å‡º**: åœ¨æ’ä»¶ä¸­ä½¿ç”¨ `Console.WriteLine()` è¾“å‡ºè°ƒè¯•ä¿¡æ¯
2. **é™„åŠ è°ƒè¯•å™¨**: åœ¨ Visual Studio ä¸­ä½¿ç”¨ "é™„åŠ åˆ°è¿›ç¨‹" åŠŸèƒ½é™„åŠ åˆ° MicroDock.exe

### Q: æ’ä»¶å¦‚ä½•è®¿é—®ä¸»åº”ç”¨çš„æœåŠ¡ï¼Ÿ

**A**: é€šè¿‡ ServiceLocator è·å–ä¸»åº”ç”¨æ³¨å†Œçš„æœåŠ¡ï¼š

```csharp
// æ³¨æ„ï¼šéœ€è¦ä¸»åº”ç”¨æä¾› ServiceLocator è®¿é—®æƒé™
var someService = ServiceLocator.GetService<ISomeService>();
```

### Q: æ’ä»¶å¯ä»¥ä½¿ç”¨å“ªäº› NuGet åŒ…ï¼Ÿ

**A**: æ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•å…¼å®¹ .NET 8.0 çš„ NuGet åŒ…ï¼Œä½†è¯·æ³¨æ„ï¼š
- é¿å…ä¸ä¸»åº”ç”¨çš„ä¾èµ–ç‰ˆæœ¬å†²çª
- å¤§å‹ä¾èµ–ä¼šå¢åŠ æ’ä»¶åŠ è½½æ—¶é—´
- å°½é‡ä½¿ç”¨è½»é‡çº§çš„åº“

### Q: å¦‚ä½•å¤„ç†æ’ä»¶é…ç½®ï¼Ÿ

**A**: å»ºè®®å°†é…ç½®ä¿å­˜åœ¨æ’ä»¶è‡ªå·±çš„ç›®å½•ä¸­ï¼š

```csharp
private string GetConfigPath()
{
    var pluginDir = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);
    return Path.Combine(pluginDir, "config.json");
}

private void LoadConfig()
{
    var configPath = GetConfigPath();
    if (File.Exists(configPath))
    {
        var json = File.ReadAllText(configPath);
        // ååºåˆ—åŒ–é…ç½®
    }
}
```

### Q: æ’ä»¶å¯ä»¥æ·»åŠ è®¾ç½®é¡¹å—ï¼Ÿ

**A**: å¯ä»¥ã€‚æ’ä»¶å¯ä»¥æä¾›è®¾ç½® UIï¼Œä¸»åº”ç”¨ä¼šåœ¨è®¾ç½®é¡µé¢çš„"æ’ä»¶è®¾ç½®"åŒºåŸŸæ˜¾ç¤ºï¼š

```csharp
public class MyPlugin : BaseMicroDockPlugin, IMicroTab
{
    // æä¾›è®¾ç½® UI
    public object SettingsControl => new MyPluginSettingsView();
}
```

### Q: é¡µé¢å†…å®¹è¿‡å¤šæ—¶å¦‚ä½•æ»šåŠ¨ï¼Ÿ

**A**: æ— éœ€ç‰¹æ®Šå¤„ç†ï¼ä¸»åº”ç”¨å·²åœ¨ NavigationView å±‚é¢æä¾›äº†ç»Ÿä¸€çš„æ»šåŠ¨æ”¯æŒã€‚åªéœ€æŒ‰æ­£å¸¸æ–¹å¼å¸ƒå±€æ‚¨çš„å†…å®¹ï¼Œå½“å†…å®¹è¶…å‡ºå¯è§†åŒºåŸŸæ—¶ä¼šè‡ªåŠ¨æ˜¾ç¤ºæ»šåŠ¨æ¡ã€‚

### Q: æˆ‘éœ€è¦åœ¨æŸä¸ªåŒºåŸŸå®ç°ç‹¬ç«‹æ»šåŠ¨æ€ä¹ˆåŠï¼Ÿ

**A**: å¦‚æœæ‚¨éœ€è¦åœ¨ç‰¹å®šåŒºåŸŸï¼ˆå¦‚åˆ—è¡¨ã€æ–‡æœ¬æ¡†ï¼‰å®ç°ç‹¬ç«‹æ»šåŠ¨ï¼Œå¯ä»¥åœ¨è¯¥åŒºåŸŸä½¿ç”¨ ScrollViewerã€‚è¯·å‚è€ƒ [UI é¡µç­¾å¼€å‘è§„èŒƒ](#ui-é¡µç­¾å¼€å‘è§„èŒƒ) ä¸­çš„"å±€éƒ¨æ»šåŠ¨åŒºåŸŸ"ç¤ºä¾‹ã€‚

### Q: æ’ä»¶å¦‚ä½•è®°å½•æ—¥å¿—ï¼Ÿ

**A**: æ’ä»¶å¯ä»¥é€šè¿‡ `Context` å±æ€§è®¿é—®æ—¥å¿—æ–¹æ³•ï¼š

```csharp
public class MyPlugin : BaseMicroDockPlugin
{
    public override void OnInit()
    {
        Context!.LogDebug("è°ƒè¯•ä¿¡æ¯");
        Context!.LogInfo("ä¸€èˆ¬ä¿¡æ¯");
        Context!.LogWarning("è­¦å‘Šä¿¡æ¯");
        Context!.LogError("é”™è¯¯ä¿¡æ¯", exception);  // å¯ä»¥åŒ…å«å¼‚å¸¸å¯¹è±¡
    }
}
```

æ‰€æœ‰æ—¥å¿—éƒ½ä¼šè‡ªåŠ¨æ·»åŠ æ’ä»¶åç§°å‰ç¼€ï¼Œå¯ä»¥åœ¨ä¸»åº”ç”¨çš„"æ—¥å¿—æŸ¥çœ‹å™¨"æ ‡ç­¾é¡µä¸­æŸ¥çœ‹ã€‚è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [æ’ä»¶ä¸Šä¸‹æ–‡ API - æ—¥å¿—ç³»ç»Ÿ](#-æ—¥å¿—ç³»ç»Ÿ)ã€‚

### Q: æ’ä»¶å¦‚ä½•ä¿å­˜å’Œè¯»å–æ•°æ®ï¼Ÿ

**A**: æ’ä»¶åº”è¯¥ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ¥å­˜å‚¨æ•°æ®ã€‚æ¨èä½¿ç”¨ JSON æ ¼å¼ä¿å­˜é…ç½®å’Œæ•°æ®ï¼š

```csharp
// ä¿å­˜é…ç½®åˆ° Data ç›®å½•
string configFile = Path.Combine(Context!.DataPath, "config.json");
string json = JsonSerializer.Serialize(myConfig, new JsonSerializerOptions { WriteIndented = true });
File.WriteAllText(configFile, json);

// è¯»å–é…ç½®
if (File.Exists(configFile))
{
    string json = File.ReadAllText(configFile);
    var config = JsonSerializer.Deserialize<MyConfig>(json);
}
```

**ç›®å½•é€‰æ‹©**:
- `Context.DataPath`: ç”¨æˆ·æ•°æ®ï¼Œä¼šå¤‡ä»½
- `Context.TempDataPath`: ä¸´æ—¶ç¼“å­˜ï¼Œä¸å¤‡ä»½
- `Context.ConfigPath`: æ’ä»¶é»˜è®¤é…ç½®ï¼Œéšæ’ä»¶æ›´æ–°è¦†ç›–

è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [æ’ä»¶ä¸Šä¸‹æ–‡ API - è·¯å¾„ç®¡ç†](#-è·¯å¾„ç®¡ç†) ç« èŠ‚ã€‚

### Q: å¦‚ä½•è®©å…¶ä»–æ’ä»¶è®¿é—®æˆ‘çš„é…ç½®ï¼Ÿ

**A**: é€šè¿‡å®šä¹‰å·¥å…·ï¼ˆToolï¼‰æš´éœ²é…ç½®ï¼š

```csharp
[MicroTool("myconfig.get", Description = "è·å–é…ç½®")]
public async Task<string> GetConfigTool()
{
    await Task.CompletedTask;
    return JsonSerializer.Serialize(new { baseUrl = _config.BaseUrl });
}
```

å…¶ä»–æ’ä»¶å¯ä»¥é€šè¿‡ `CallToolAsync` è°ƒç”¨è·å–é…ç½®ã€‚è¯¦è§ [é€šè¿‡å·¥å…·å…±äº«é…ç½®](#-é€šè¿‡å·¥å…·å…±äº«é…ç½®)ã€‚

### Q: æ’ä»¶å¦‚ä½•æ˜¾ç¤ºé€šçŸ¥ï¼Ÿ

**A**: æ’ä»¶å¯ä»¥é€šè¿‡ä¸Šä¸‹æ–‡ API æ˜¾ç¤ºé€šçŸ¥ï¼š

```csharp
// åº”ç”¨å†…é€šçŸ¥
Context!.ShowInAppNotification("æ ‡é¢˜", "æ¶ˆæ¯", NotificationType.Success);

// ç³»ç»Ÿæ‰˜ç›˜é€šçŸ¥
Context!.ShowSystemNotification("æ ‡é¢˜", "æ¶ˆæ¯");
```

æ³¨æ„ï¼šé€šçŸ¥ API éœ€è¦é€šè¿‡ `Context` å±æ€§è®¿é—®ï¼ˆ`Context` æ˜¯ `public` çš„ï¼‰ï¼Œè€Œä¸æ˜¯åŸºç±»çš„ä¾¿æ·æ–¹æ³•ã€‚

---

## ç¤ºä¾‹æ’ä»¶

### å®Œæ•´ç¤ºä¾‹ï¼šå¤©æ°”æ’ä»¶

å‚è€ƒ `Test` é¡¹ç›®è·å–å®Œæ•´çš„æ’ä»¶å®ç°ç¤ºä¾‹ï¼š

```
Test/
â”œâ”€â”€ TestPlugin.cs           # æ’ä»¶ä¸»ç±»
â”œâ”€â”€ TestTab.axaml          # UI å®šä¹‰
â””â”€â”€ TestTab.axaml.cs       # UI ä»£ç åç«¯
```

### æ›´å¤šèµ„æº

- **æ’ä»¶æ¡†æ¶æ–‡æ¡£**: [MicroDock.Plugin/CLAUDE.md](../MicroDock.Plugin/CLAUDE.md)
- **ä¸»åº”ç”¨æ¨¡å—æ–‡æ¡£**: [MicroDock/CLAUDE.md](../MicroDock/CLAUDE.md)
- **é¡¹ç›®æ¶æ„æ–‡æ¡£**: [CLAUDE.md](../CLAUDE.md)

---

## ç‰ˆæœ¬æ›´æ–°æ—¥å¿—

### v3.3.0 (2025-11-27)
- ğŸš€ **é‡å¤§æ›´æ–°**: ç§»é™¤æ’ä»¶æ•°æ®å­˜å‚¨ APIï¼Œæ’ä»¶æ”¹ä¸ºè‡ªè¡Œç®¡ç†æ•°æ®
- âŒ **ç§»é™¤**: `SetValue`/`GetValue` é”®å€¼å­˜å‚¨ API
- âŒ **ç§»é™¤**: `SetSettings`/`GetSettings` è®¾ç½®ç®¡ç† API
- âŒ **ç§»é™¤**: `GetValueFromDependency`/`GetSettingsFromDependency` ä¾èµ–è®¿é—® API
- âœ¨ **æ–°å¢**: é€šè¿‡å·¥å…·å…±äº«é…ç½®çš„ç¤ºä¾‹è¯´æ˜
- ğŸ“ **æ›´æ–°**: è·¯å¾„ç®¡ç†ç« èŠ‚ï¼Œæ·»åŠ ä½¿ç”¨ JSON æ–‡ä»¶å­˜å‚¨é…ç½®çš„ç¤ºä¾‹
- ğŸ“ **æ›´æ–°**: å¸¸è§é—®é¢˜ï¼Œæ›´æ–°æ•°æ®å­˜å‚¨ç›¸å…³è¯´æ˜
- âš ï¸ **ç ´åæ€§å˜æ›´**: ä½¿ç”¨äº†æ—§ API çš„æ’ä»¶éœ€è¦è¿ç§»åˆ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨

### v3.2.0 (2025-11-14)
- ğŸ“ **æ–°å¢**: æ·»åŠ å®Œæ•´çš„æ’ä»¶ä¸Šä¸‹æ–‡ API æ–‡æ¡£
- âœ¨ **æ–°å¢**: è¯¦ç»†çš„æ—¥å¿—ç³»ç»Ÿä½¿ç”¨è¯´æ˜å’Œæœ€ä½³å®è·µ
- âœ¨ **æ–°å¢**: å›¾ç‰‡ç®¡ç†ã€è·¯å¾„ç®¡ç†ã€é€šçŸ¥ç³»ç»Ÿç­‰ API è¯´æ˜
- âœ¨ **æ–°å¢**: Loading æŒ‡ç¤ºå™¨å’Œæ‰˜ç›˜èœå• API è¯´æ˜
- ğŸ“ **å®Œå–„**: æ·»åŠ æ—¥å¿—ç›¸å…³çš„å¸¸è§é—®é¢˜è§£ç­”
- ğŸ“ **å®Œå–„**: æ›´æ–°å¸¸è§é—®é¢˜ï¼Œæ·»åŠ æ•°æ®å­˜å‚¨å’Œé€šçŸ¥ç›¸å…³é—®é¢˜
- âœ… **ä¿®æ­£**: æ‰€æœ‰æ—¥å¿—ç¤ºä¾‹ç»Ÿä¸€ä½¿ç”¨ `Context!.LogXXX` æ–¹å¼è®¿é—®

### v3.1.0 (2025-11-14)
- ğŸ“ **æ–‡æ¡£æ›´æ–°**: åŸºäºå®é™…ä»£ç æ›´æ–°æ’ä»¶å¼€å‘æŒ‡å—
- âœ… ä¿®æ­£ `IMicroTab` æ¥å£è¯´æ˜ï¼ˆ`IconSymbol` è€Œé `IconSource`ï¼‰
- âœ… ç§»é™¤ä¸å­˜åœ¨çš„ `IMicroActionsProvider` æ¥å£è¯´æ˜
- âœ… æ›´æ­£ `CallToolAsync` å‚æ•°ç±»å‹ï¼ˆ`Dictionary<string, string>` è€Œé `Dictionary<string, object>`ï¼‰
- âœ… å®Œå–„ç±»å‹è½¬æ¢æœºåˆ¶è¯´æ˜ï¼ˆè°ƒç”¨è€…éœ€è¦åºåˆ—åŒ–å¤æ‚å¯¹è±¡ä¸º JSONï¼‰
- âœ… æ·»åŠ æ›´è¯¦ç»†çš„å‚æ•°ç±»å‹å’Œè°ƒç”¨ç¤ºä¾‹
- âœ… å¢åŠ  IMicroTab å®ç°è¯´æ˜ï¼ˆView ç±»éœ€è¦ç»§æ‰¿ UserControl å¹¶å®ç° IMicroTabï¼‰

### v3.0.0 (2025-11-13)
- ğŸš€ **é‡å¤§æ›´æ–°**: å¼•å…¥æ’ä»¶å·¥å…·è°ƒç”¨ç³»ç»Ÿ
- âœ¨ æ·»åŠ  `MicroToolAttribute` å’Œ `ToolParameterAttribute` ç‰¹æ€§
- âœ¨ å®ç°å·¥å…·è‡ªåŠ¨å‘ç°å’Œæ³¨å†Œæœºåˆ¶
- âœ¨ æ”¯æŒå¼ºç±»å‹å‚æ•°å’Œè‡ªåŠ¨ç±»å‹è½¬æ¢
- âœ¨ æ·»åŠ  `OnAllPluginsLoaded()` ç”Ÿå‘½å‘¨æœŸå›è°ƒ
- âœ¨ å®ç°å·¥å…·å‘ç° API å’Œç»Ÿè®¡åŠŸèƒ½
- ğŸ¨ è®¾ç½®ç•Œé¢è‡ªåŠ¨æ˜¾ç¤ºæ’ä»¶æ³¨å†Œçš„å·¥å…·
- ğŸ“ è¯¦ç»†çš„å·¥å…·ç³»ç»Ÿæ–‡æ¡£å’Œç¤ºä¾‹
- ğŸ“ æ›´æ–° Test æ’ä»¶ï¼Œæ·»åŠ 4ä¸ªå·¥å…·ç¤ºä¾‹

### v2.0.0 (2025-11-13)
- ğŸš€ **é‡å¤§æ›´æ–°**: å¼•å…¥ `plugin.json` é…ç½®æ–‡ä»¶ç³»ç»Ÿ
- âœ¨ ç®€åŒ–æ’ä»¶æ¥å£ï¼Œç§»é™¤å…ƒæ•°æ®ç›¸å…³å±æ€§
- ğŸ“ è¯¦ç»†è¯´æ˜ `plugin.json` æ‰€æœ‰å­—æ®µå’Œä½¿ç”¨æ–¹æ³•
- ğŸ“ æ·»åŠ åå‘åŸŸåå‘½åè§„èŒƒå’Œç‰ˆæœ¬ç®¡ç†è¯´æ˜
- ğŸ“ æ·»åŠ æ’ä»¶ä¾èµ–ç®¡ç†å’Œç‰ˆæœ¬èŒƒå›´è¯­æ³•
- ğŸ“ æ›´æ–°å¿«é€Ÿå¼€å§‹æŒ‡å—ï¼Œé€‚é…æ–°çš„æ’ä»¶å¼€å‘æµç¨‹
- ğŸ“ æ›´æ–°ç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºæ–°æ¥å£ç”¨æ³•
- âš ï¸ **ç ´åæ€§å˜æ›´**: ä¸å†å…¼å®¹æ—§ç‰ˆæœ¬æ’ä»¶ï¼Œæ‰€æœ‰æ’ä»¶å¿…é¡»æä¾› plugin.json

### v1.0.0 (2025-11-13)
- âœ¨ é¦–æ¬¡å‘å¸ƒæ’ä»¶å¼€å‘æŒ‡å—
- ğŸ“ æ·»åŠ  ScrollViewer ä½¿ç”¨è§„èŒƒ
- ğŸ“ æ·»åŠ  UI é¡µç­¾å¼€å‘æœ€ä½³å®è·µ
- ğŸ“ æ·»åŠ å¸¸è§é—®é¢˜è§£ç­”

---

## åé¦ˆä¸æ”¯æŒ

å¦‚æœæ‚¨åœ¨æ’ä»¶å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Œæ¬¢è¿ï¼š
- æäº¤ Issue åˆ°é¡¹ç›®ä»“åº“
- å‚ä¸é¡¹ç›®è®¨è®º
- è´¡çŒ®ç¤ºä¾‹æ’ä»¶ä»£ç 

ç¥æ‚¨å¼€å‘æ„‰å¿«ï¼ğŸ‰

